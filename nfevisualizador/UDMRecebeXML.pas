unit UDMRecebeXML;

interface

uses
  SysUtils, Classes, FMTBcd, DB, DBClient, Provider, SqlExpr, xmldom, Xmlxform, Messages, dialogs, LogTypes, Variants;

type
  TDMRecebeXML = class(TDataModule)
    sdsCFOP: TSQLDataSet;
    dspCFOP: TDataSetProvider;
    cdsCFOP: TClientDataSet;
    dsCFOP: TDataSource;
    cdsCFOPID: TIntegerField;
    cdsCFOPCODCFOP: TStringField;
    cdsCFOPNOME: TStringField;
    cdsCFOPGERAR_IPI: TStringField;
    cdsCFOPGERAR_ICMS: TStringField;
    cdsCFOPGERAR_DUPLICATA: TStringField;
    cdsCFOPSOMAR_VLRTOTALPRODUTO: TStringField;
    cdsCFOPNOME_INTERNO: TStringField;
    cdsCFOPID_CSTICMS: TIntegerField;
    cdsCFOPID_CSTIPI: TIntegerField;
    cdsCFOPCOPIARNOTATRIANGULAR: TStringField;
    cdsCFOPID_PIS: TIntegerField;
    cdsCFOPID_COFINS: TIntegerField;
    cdsCFOPTIPO_PIS: TStringField;
    cdsCFOPTIPO_COFINS: TStringField;
    cdsCFOPGERAR_ICMS_SIMPLES: TStringField;
    cdsCFOPTIPO_EMPRESA: TStringField;
    cdsCFOPSUBSTITUICAO_TRIB: TStringField;
    cdsCFOPMVA: TStringField;
    cdsCFOPPERC_COFINS: TFloatField;
    cdsCFOPPERC_PIS: TFloatField;
    cdsCFOPLEI: TMemoField;
    cdsCFOPBENEFICIAMENTO: TStringField;
    XMLTransformProvider1: TXMLTransformProvider;
    cdsCabecalho: TClientDataSet;
    cdsCabecalhoversao: TStringField;
    cdsCabecalhoinfNFe_Id: TStringField;
    cdsCabecalhocUF: TIntegerField;
    cdsCabecalhocNF: TIntegerField;
    cdsCabecalhonatOp: TStringField;
    cdsCabecalhoindPag: TIntegerField;
    cdsCabecalhomod: TStringField;
    cdsCabecalhoserie: TIntegerField;
    cdsCabecalhonNF: TIntegerField;
    cdsCabecalhodSaiEnt: TDateField;
    cdsCabecalhohSaiEnt: TStringField;
    cdsCabecalhotpNF: TIntegerField;
    cdsCabecalhoIEST: TStringField;
    cdsCabecalhocMunFG1: TIntegerField;
    cdsCabecalhotpImp: TIntegerField;
    cdsCabecalhotpEmis: TIntegerField;
    cdsCabecalhocDV: TIntegerField;
    cdsCabecalhotpAmb: TStringField;
    cdsCabecalhofinNFe: TIntegerField;
    cdsCabecalhoprocEmi: TIntegerField;
    cdsCabecalhoverProc: TStringField;
    cdsCabecalhodhCont: TDateField;
    cdsCabecalhoxJust: TStringField;
    cdsCabecalhoemit_CNPJ: TStringField;
    cdsCabecalhoemit_CPF: TStringField;
    cdsCabecalhoemit_xNome: TStringField;
    cdsCabecalhoxFant: TStringField;
    cdsCabecalhoenderEmit_xLgr: TStringField;
    cdsCabecalhoenderEmit_nro: TStringField;
    cdsCabecalhoenderEmit_xCpl: TStringField;
    cdsCabecalhoenderEmit_xBairro: TStringField;
    cdsCabecalhoenderEmit_cMun: TIntegerField;
    cdsCabecalhoenderEmit_xMun: TStringField;
    cdsCabecalhoenderEmit_UF: TStringField;
    cdsCabecalhoenderEmit_CEP: TIntegerField;
    cdsCabecalhoenderEmit_cPais: TIntegerField;
    cdsCabecalhoenderEmit_xPais: TStringField;
    cdsCabecalhoenderEmit_fone: TStringField;
    cdsCabecalhoemit_IE: TStringField;
    cdsCabecalhoIM: TStringField;
    cdsCabecalhoCNAE: TStringField;
    cdsCabecalhoCRT: TIntegerField;
    cdsCabecalhoavulsa_CNPJ: TStringField;
    cdsCabecalhoxOrgao: TStringField;
    cdsCabecalhomatr: TStringField;
    cdsCabecalhoxAgente: TStringField;
    cdsCabecalhofone: TStringField;
    cdsCabecalhoavulsa_UF: TStringField;
    cdsCabecalhonDAR: TStringField;
    cdsCabecalhoavulsa_dEmi: TDateField;
    cdsCabecalhovDAR: TFloatField;
    cdsCabecalhorepEmi: TStringField;
    cdsCabecalhodPag: TDateField;
    cdsCabecalhodest_CNPJ: TStringField;
    cdsCabecalhodest_CPF: TStringField;
    cdsCabecalhodest_xNome: TStringField;
    cdsCabecalhoenderDest_xLgr: TStringField;
    cdsCabecalhoenderDest_nro: TStringField;
    cdsCabecalhoenderDest_xCpl: TStringField;
    cdsCabecalhoenderDest_xBairro: TStringField;
    cdsCabecalhoenderDest_cMun: TIntegerField;
    cdsCabecalhoenderDest_xMun: TStringField;
    cdsCabecalhoenderDest_UF: TStringField;
    cdsCabecalhoenderDest_CEP: TIntegerField;
    cdsCabecalhoenderDest_cPais: TIntegerField;
    cdsCabecalhoenderDest_xPais: TStringField;
    cdsCabecalhoenderDest_fone: TStringField;
    cdsCabecalhodest_IE: TStringField;
    cdsCabecalhoISUF: TStringField;
    cdsCabecalhoemail: TStringField;
    cdsCabecalhoretirada_CNPJ: TStringField;
    cdsCabecalhoretirada_CPF: TStringField;
    cdsCabecalhoretirada_xLgr: TStringField;
    cdsCabecalhoretirada_nro: TStringField;
    cdsCabecalhoretirada_xCpl: TStringField;
    cdsCabecalhoretirada_xBairro: TStringField;
    cdsCabecalhoretirada_cMun: TIntegerField;
    cdsCabecalhoretirada_xMun: TStringField;
    cdsCabecalhoretirada_UF: TStringField;
    cdsCabecalhoentrega_CNPJ: TStringField;
    cdsCabecalhoentrega_CPF: TStringField;
    cdsCabecalhoentrega_xLgr: TStringField;
    cdsCabecalhoentrega_nro: TStringField;
    cdsCabecalhoentrega_xCpl: TStringField;
    cdsCabecalhoentrega_xBairro: TStringField;
    cdsCabecalhoentrega_cMun: TIntegerField;
    cdsCabecalhoentrega_xMun: TStringField;
    cdsCabecalhoentrega_UF: TStringField;
    cdsCabecalhoICMSTot_vBC: TFloatField;
    cdsCabecalhovICMS: TFloatField;
    cdsCabecalhovBCST: TFloatField;
    cdsCabecalhovST: TFloatField;
    cdsCabecalhovProd: TFloatField;
    cdsCabecalhovFrete: TFloatField;
    cdsCabecalhovSeg: TFloatField;
    cdsCabecalhoICMSTot_vDesc: TFloatField;
    cdsCabecalhovII: TFloatField;
    cdsCabecalhovIPI: TFloatField;
    cdsCabecalhoICMSTot_vPIS: TFloatField;
    cdsCabecalhoICMSTot_vCOFINS: TFloatField;
    cdsCabecalhovOutro: TFloatField;
    cdsCabecalhovNF: TFloatField;
    cdsCabecalhoISSQNtot_vServ: TFloatField;
    cdsCabecalhoISSQNtot_vBC: TFloatField;
    cdsCabecalhovISS: TFloatField;
    cdsCabecalhoISSQNtot_vPIS: TFloatField;
    cdsCabecalhoISSQNtot_vCOFINS: TFloatField;
    cdsCabecalhovRetPIS: TFloatField;
    cdsCabecalhovRetCOFINS: TFloatField;
    cdsCabecalhovRetCSLL: TFloatField;
    cdsCabecalhovBCIRRF: TFloatField;
    cdsCabecalhovIRRF: TFloatField;
    cdsCabecalhovBCRetPrev: TFloatField;
    cdsCabecalhovRetPrev: TFloatField;
    cdsCabecalhomodFrete: TIntegerField;
    cdsCabecalhoCNPJ: TStringField;
    cdsCabecalhoCPF: TStringField;
    cdsCabecalhoxNome: TStringField;
    cdsCabecalhoIE: TStringField;
    cdsCabecalhoxEnder: TStringField;
    cdsCabecalhotransporta_xMun: TStringField;
    cdsCabecalhotransporta_UF: TStringField;
    cdsCabecalhoretTransp_vServ: TFloatField;
    cdsCabecalhovBCRet: TFloatField;
    cdsCabecalhopICMSRet: TFloatField;
    cdsCabecalhovICMSRet: TFloatField;
    cdsCabecalhoCFOP: TIntegerField;
    cdsCabecalhocMunFG2: TIntegerField;
    cdsCabecalhoveicTransp_placa: TStringField;
    cdsCabecalhoveicTransp_UF: TStringField;
    cdsCabecalhoveicTransp_RNTC: TStringField;
    cdsCabecalhoreboque_placa: TStringField;
    cdsCabecalhoreboque_UF: TStringField;
    cdsCabecalhoreboque_RNTC: TStringField;
    cdsCabecalhovagao: TStringField;
    cdsCabecalhobalsa: TStringField;
    cdsCabecalhonFat: TStringField;
    cdsCabecalhovOrig: TFloatField;
    cdsCabecalhofat_vDesc: TFloatField;
    cdsCabecalhovLiq: TFloatField;
    cdsCabecalhoinfAdFisco: TStringField;
    cdsCabecalhoinfCpl: TStringField;
    cdsCabecalhoobsCont_xCampo: TStringField;
    cdsCabecalhoobsCont_xTexto: TStringField;
    cdsCabecalhoobsFisco_xCampo: TStringField;
    cdsCabecalhoobsFisco_xTexto: TStringField;
    cdsCabecalhoUFEmbarq: TStringField;
    cdsCabecalhoxLocEmbarq: TStringField;
    cdsCabecalhoxNEmp: TStringField;
    cdsCabecalhoxPed: TStringField;
    cdsCabecalhoxCont: TStringField;
    cdsCabecalhoSignature_Id: TStringField;
    cdsCabecalhoSignedInfo_Id: TStringField;
    cdsCabecalhoAlgorithm1: TStringField;
    cdsCabecalhoSignatureMethod_Algorithm: TStringField;
    cdsCabecalhoId: TStringField;
    cdsCabecalhoURI: TStringField;
    cdsCabecalhoType: TStringField;
    cdsCabecalhoAlgorithm2: TStringField;
    cdsCabecalhoXPath: TStringField;
    cdsCabecalhoAlgorithm3: TStringField;
    cdsCabecalhoDigestValue: TStringField;
    cdsCabecalhoSignatureValue_Id: TStringField;
    cdsCabecalhoKeyInfo_Id: TStringField;
    cdsCabecalhoX509Certificate: TStringField;
    cdsCabecalhoNFref: TDataSetField;
    cdsCabecalhodet: TDataSetField;
    cdsCabecalhovol: TDataSetField;
    cdsCabecalhodup: TDataSetField;
    cdsCabecalhoprocRef: TDataSetField;
    cdsCabecalhoprotNFe: TDataSetField;
    dsCabecalho: TDataSource;
    cdsNFeRef: TClientDataSet;
    cdsNFeRefrefNFe: TIntegerField;
    cdsNFeRefrefNF_cUF: TIntegerField;
    cdsNFeRefrefNF_AAMM: TIntegerField;
    cdsNFeRefrefNF_CNPJ: TStringField;
    cdsNFeRefrefNF_mod: TStringField;
    cdsNFeRefrefNF_serie: TIntegerField;
    cdsNFeRefrefNF_nNF: TIntegerField;
    cdsNFeRefrefNFP_cUF: TIntegerField;
    cdsNFeRefrefNFP_AAMM: TIntegerField;
    cdsNFeRefrefNFP_CNPJ: TStringField;
    cdsNFeRefCPF: TStringField;
    cdsNFeRefIE: TStringField;
    cdsNFeRefrefNFP_mod: TStringField;
    cdsNFeRefrefNFP_serie: TIntegerField;
    cdsNFeRefrefNFP_nNF: TIntegerField;
    cdsNFeRefrefCTe: TIntegerField;
    cdsNFeRefrefECF_mod: TStringField;
    cdsNFeRefnECF: TIntegerField;
    cdsNFeRefnCOO: TIntegerField;
    cdsNFeProtocolo: TClientDataSet;
    cdsNFeProtocoloversao: TStringField;
    cdsNFeProtocoloId: TStringField;
    cdsNFeProtocolotpAmb: TStringField;
    cdsNFeProtocoloverAplic: TStringField;
    cdsNFeProtocolochNFe: TStringField;
    cdsNFeProtocolodhRecbto: TStringField;
    cdsNFeProtocolonProt: TStringField;
    cdsNFeProtocolodigVal: TStringField;
    cdsNFeProtocolocStat: TStringField;
    cdsNFeProtocoloxMotivo: TStringField;
    dsNFeProtocolo: TDataSource;
    dsNFeRef: TDataSource;
    dsParcelas: TDataSource;
    cdsParcelas: TClientDataSet;
    cdsParcelasnDup: TStringField;
    cdsParcelasdVenc: TDateField;
    cdsParcelasvDup: TFloatField;
    cdsDetalhe: TClientDataSet;
    cdsDetalhenItem: TIntegerField;
    cdsDetalhecProd: TStringField;
    cdsDetalhecEAN: TStringField;
    cdsDetalhexProd: TStringField;
    cdsDetalheNCM: TStringField;
    cdsDetalheEXTIPI: TStringField;
    cdsDetalheCFOP: TIntegerField;
    cdsDetalheuCom: TStringField;
    cdsDetalheqCom: TFloatField;
    cdsDetalhevUnCom: TFloatField;
    cdsDetalhevProd: TFloatField;
    cdsDetalhecEANTrib: TStringField;
    cdsDetalheuTrib: TStringField;
    cdsDetalheqTrib: TFloatField;
    cdsDetalhevUnTrib: TFloatField;
    cdsDetalhevFrete: TFloatField;
    cdsDetalhevSeg: TFloatField;
    cdsDetalhevDesc: TFloatField;
    cdsDetalhevOutro: TFloatField;
    cdsDetalheindTot: TIntegerField;
    cdsDetalhexPed: TStringField;
    cdsDetalhenItemPed: TIntegerField;
    cdsDetalhetpOp: TIntegerField;
    cdsDetalhechassi: TStringField;
    cdsDetalhecCor: TStringField;
    cdsDetalhexCor: TStringField;
    cdsDetalhepot: TStringField;
    cdsDetalhecilin: TStringField;
    cdsDetalhepesoL: TFloatField;
    cdsDetalhepesoB: TFloatField;
    cdsDetalhenSerie: TStringField;
    cdsDetalhetpComb: TStringField;
    cdsDetalhenMotor: TStringField;
    cdsDetalheCMT: TStringField;
    cdsDetalhedist: TStringField;
    cdsDetalheanoMod: TIntegerField;
    cdsDetalheanoFab: TIntegerField;
    cdsDetalhetpPint: TStringField;
    cdsDetalhetpVeic: TIntegerField;
    cdsDetalheespVeic: TIntegerField;
    cdsDetalheVIN: TStringField;
    cdsDetalhecondVeic: TIntegerField;
    cdsDetalhecMod: TIntegerField;
    cdsDetalhecCorDENATRAN: TIntegerField;
    cdsDetalhelota: TIntegerField;
    cdsDetalhetpRest: TIntegerField;
    cdsDetalhecProdANP: TIntegerField;
    cdsDetalheCODIF: TIntegerField;
    cdsDetalheqTemp: TFloatField;
    cdsDetalheUFCons: TStringField;
    cdsDetalheCIDE_qBCProd: TFloatField;
    cdsDetalheCIDE_vAliqProd: TFloatField;
    cdsDetalhevCIDE: TFloatField;
    cdsDetalheICMS00_orig: TIntegerField;
    cdsDetalheICMS00_CST: TIntegerField;
    cdsDetalheICMS00_modBC: TIntegerField;
    cdsDetalheICMS00_vBC: TFloatField;
    cdsDetalheICMS00_pICMS: TFloatField;
    cdsDetalheICMS00_vICMS: TFloatField;
    cdsDetalheICMS10_orig: TIntegerField;
    cdsDetalheICMS10_CST: TIntegerField;
    cdsDetalheICMS10_modBC: TIntegerField;
    cdsDetalheICMS10_vBC: TFloatField;
    cdsDetalheICMS10_pICMS: TFloatField;
    cdsDetalheICMS10_vICMS: TFloatField;
    cdsDetalheICMS10_modBCST: TIntegerField;
    cdsDetalheICMS10_pMVAST: TFloatField;
    cdsDetalheICMS10_pRedBCST: TFloatField;
    cdsDetalheICMS10_vBCST: TFloatField;
    cdsDetalheICMS10_pICMSST: TFloatField;
    cdsDetalheICMS10_vICMSST: TFloatField;
    cdsDetalheICMS20_orig: TIntegerField;
    cdsDetalheICMS20_CST: TIntegerField;
    cdsDetalheICMS20_modBC: TIntegerField;
    cdsDetalheICMS20_pRedBC: TFloatField;
    cdsDetalheICMS20_vBC: TFloatField;
    cdsDetalheICMS20_pICMS: TFloatField;
    cdsDetalheICMS20_vICMS: TFloatField;
    cdsDetalheICMS30_orig: TIntegerField;
    cdsDetalheICMS30_CST: TIntegerField;
    cdsDetalheICMS30_modBCST: TIntegerField;
    cdsDetalheICMS30_pMVAST: TFloatField;
    cdsDetalheICMS30_pRedBCST: TFloatField;
    cdsDetalheICMS30_vBCST: TFloatField;
    cdsDetalheICMS30_pICMSST: TFloatField;
    cdsDetalheICMS30_vICMSST: TFloatField;
    cdsDetalheICMS40_orig: TIntegerField;
    cdsDetalheICMS40_CST: TIntegerField;
    cdsDetalheICMS40_vICMS: TFloatField;
    cdsDetalhemotDesICMS: TIntegerField;
    cdsDetalheICMS51_orig: TIntegerField;
    cdsDetalheICMS51_CST: TIntegerField;
    cdsDetalheICMS51_modBC: TIntegerField;
    cdsDetalheICMS51_pRedBC: TFloatField;
    cdsDetalheICMS51_vBC: TFloatField;
    cdsDetalheICMS51_pICMS: TFloatField;
    cdsDetalheICMS51_vICMS: TFloatField;
    cdsDetalheICMS60_orig: TIntegerField;
    cdsDetalheICMS60_CST: TIntegerField;
    cdsDetalheICMS60_vBCSTRet: TFloatField;
    cdsDetalheICMS60_vICMSSTRet: TFloatField;
    cdsDetalheICMS70_orig: TIntegerField;
    cdsDetalheICMS70_CST: TIntegerField;
    cdsDetalheICMS70_modBC: TIntegerField;
    cdsDetalheICMS70_pRedBC: TFloatField;
    cdsDetalheICMS70_vBC: TFloatField;
    cdsDetalheICMS70_pICMS: TFloatField;
    cdsDetalheICMS70_vICMS: TFloatField;
    cdsDetalheICMS70_modBCST: TIntegerField;
    cdsDetalheICMS70_pMVAST: TFloatField;
    cdsDetalheICMS70_pRedBCST: TFloatField;
    cdsDetalheICMS70_vBCST: TFloatField;
    cdsDetalheICMS70_pICMSST: TFloatField;
    cdsDetalheICMS70_vICMSST: TFloatField;
    cdsDetalheICMS90_orig: TIntegerField;
    cdsDetalheICMS90_CST: TIntegerField;
    cdsDetalheICMS90_modBC: TIntegerField;
    cdsDetalheICMS90_vBC: TFloatField;
    cdsDetalheICMS90_pRedBC: TFloatField;
    cdsDetalheICMS90_pICMS: TFloatField;
    cdsDetalheICMS90_vICMS: TFloatField;
    cdsDetalheICMS90_modBCST: TIntegerField;
    cdsDetalheICMS90_pMVAST: TFloatField;
    cdsDetalheICMS90_pRedBCST: TFloatField;
    cdsDetalheICMS90_vBCST: TFloatField;
    cdsDetalheICMS90_pICMSST: TFloatField;
    cdsDetalheICMS90_vICMSST: TFloatField;
    cdsDetalheICMSPart_orig: TIntegerField;
    cdsDetalheICMSPart_CST: TIntegerField;
    cdsDetalheICMSPart_modBC: TIntegerField;
    cdsDetalheICMSPart_vBC: TFloatField;
    cdsDetalheICMSPart_pRedBC: TFloatField;
    cdsDetalheICMSPart_pICMS: TFloatField;
    cdsDetalheICMSPart_vICMS: TFloatField;
    cdsDetalheICMSPart_modBCST: TIntegerField;
    cdsDetalheICMSPart_pMVAST: TFloatField;
    cdsDetalheICMSPart_pRedBCST: TFloatField;
    cdsDetalheICMSPart_vBCST: TFloatField;
    cdsDetalheICMSPart_pICMSST: TFloatField;
    cdsDetalheICMSPart_vICMSST: TFloatField;
    cdsDetalhepBCOp: TFloatField;
    cdsDetalheUFST: TStringField;
    cdsDetalheICMSST_orig: TIntegerField;
    cdsDetalheICMSST_CST: TIntegerField;
    cdsDetalheICMSST_vBCSTRet: TFloatField;
    cdsDetalheICMSST_vICMSSTRet: TFloatField;
    cdsDetalhevBCSTDest: TFloatField;
    cdsDetalhevICMSSTDest: TFloatField;
    cdsDetalheICMSSN101_orig: TIntegerField;
    cdsDetalheICMSSN101_CSOSN: TIntegerField;
    cdsDetalheICMSSN101_pCredSN: TFloatField;
    cdsDetalheICMSSN101_vCredICMSSN: TFloatField;
    cdsDetalheICMSSN102_orig: TIntegerField;
    cdsDetalheICMSSN102_CSOSN: TIntegerField;
    cdsDetalheICMSSN201_orig: TIntegerField;
    cdsDetalheICMSSN201_CSOSN: TIntegerField;
    cdsDetalheICMSSN201_modBCST: TIntegerField;
    cdsDetalheICMSSN201_pMVAST: TFloatField;
    cdsDetalheICMSSN201_pRedBCST: TFloatField;
    cdsDetalheICMSSN201_vBCST: TFloatField;
    cdsDetalheICMSSN201_pICMSST: TFloatField;
    cdsDetalheICMSSN201_vICMSST: TFloatField;
    cdsDetalheICMSSN201_pCredSN: TFloatField;
    cdsDetalheICMSSN201_vCredICMSSN: TFloatField;
    cdsDetalheICMSSN202_orig: TIntegerField;
    cdsDetalheICMSSN202_CSOSN: TIntegerField;
    cdsDetalheICMSSN202_modBCST: TIntegerField;
    cdsDetalheICMSSN202_pMVAST: TFloatField;
    cdsDetalheICMSSN202_pRedBCST: TFloatField;
    cdsDetalheICMSSN202_vBCST: TFloatField;
    cdsDetalheICMSSN202_pICMSST: TFloatField;
    cdsDetalheICMSSN202_vICMSST: TFloatField;
    cdsDetalheICMSSN500_orig: TIntegerField;
    cdsDetalheICMSSN500_CSOSN: TIntegerField;
    cdsDetalheICMSSN500_vBCSTRet: TFloatField;
    cdsDetalheICMSSN500_vICMSSTRet: TFloatField;
    cdsDetalheICMSSN900_orig: TIntegerField;
    cdsDetalheICMSSN900_CSOSN: TIntegerField;
    cdsDetalheICMSSN900_modBC: TIntegerField;
    cdsDetalheICMSSN900_vBC: TFloatField;
    cdsDetalheICMSSN900_pRedBC: TFloatField;
    cdsDetalheICMSSN900_pICMS: TFloatField;
    cdsDetalheICMSSN900_vICMS: TFloatField;
    cdsDetalheICMSSN900_modBCST: TIntegerField;
    cdsDetalheICMSSN900_pMVAST: TFloatField;
    cdsDetalheICMSSN900_pRedBCST: TFloatField;
    cdsDetalheICMSSN900_vBCST: TFloatField;
    cdsDetalheICMSSN900_pICMSST: TFloatField;
    cdsDetalheICMSSN900_vICMSST: TFloatField;
    cdsDetalheICMSSN900_pCredSN: TFloatField;
    cdsDetalheICMSSN900_vCredICMSSN: TFloatField;
    cdsDetalheclEnq: TStringField;
    cdsDetalheCNPJProd: TStringField;
    cdsDetalhecSelo: TStringField;
    cdsDetalheqSelo: TIntegerField;
    cdsDetalhecEnq: TStringField;
    cdsDetalheIPITrib_CST: TIntegerField;
    cdsDetalheIPITrib_vBC: TFloatField;
    cdsDetalhepIPI: TFloatField;
    cdsDetalheqUnid: TFloatField;
    cdsDetalhevUnid: TFloatField;
    cdsDetalhevIPI: TFloatField;
    cdsDetalheIPINT_CST: TIntegerField;
    cdsDetalheII_vBC: TFloatField;
    cdsDetalhevDespAdu: TFloatField;
    cdsDetalhevII: TFloatField;
    cdsDetalhevIOF: TFloatField;
    cdsDetalheISSQN_vBC: TFloatField;
    cdsDetalhevAliq: TFloatField;
    cdsDetalhevISSQN: TFloatField;
    cdsDetalhecMunFG: TIntegerField;
    cdsDetalhecListServ: TIntegerField;
    cdsDetalhecSitTrib: TStringField;
    cdsDetalhePISAliq_CST: TIntegerField;
    cdsDetalhePISAliq_vBC: TFloatField;
    cdsDetalhePISAliq_pPIS: TFloatField;
    cdsDetalhePISAliq_vPIS: TFloatField;
    cdsDetalhePISQtde_CST: TIntegerField;
    cdsDetalhePISQtde_qBCProd: TFloatField;
    cdsDetalhePISQtde_vAliqProd: TFloatField;
    cdsDetalhePISQtde_vPIS: TFloatField;
    cdsDetalhePISNT_CST: TIntegerField;
    cdsDetalhePISOutr_CST: TIntegerField;
    cdsDetalhePISOutr_vBC: TFloatField;
    cdsDetalhePISOutr_pPIS: TFloatField;
    cdsDetalhePISOutr_qBCProd: TFloatField;
    cdsDetalhePISOutr_vAliqProd: TFloatField;
    cdsDetalhePISOutr_vPIS: TFloatField;
    cdsDetalhePISST_vBC: TFloatField;
    cdsDetalhepPIS: TFloatField;
    cdsDetalhePISST_qBCProd: TFloatField;
    cdsDetalhePISST_vAliqProd: TFloatField;
    cdsDetalhevPIS: TFloatField;
    cdsDetalheCOFINSAliq_CST: TIntegerField;
    cdsDetalheCOFINSAliq_vBC: TFloatField;
    cdsDetalheCOFINSAliq_pCOFINS: TFloatField;
    cdsDetalheCOFINSAliq_vCOFINS: TFloatField;
    cdsDetalheCOFINSQtde_CST: TIntegerField;
    cdsDetalheCOFINSQtde_qBCProd: TFloatField;
    cdsDetalheCOFINSQtde_vAliqProd: TFloatField;
    cdsDetalheCOFINSQtde_vCOFINS: TFloatField;
    cdsDetalheCOFINSNT_CST: TIntegerField;
    cdsDetalheCOFINSOutr_CST: TIntegerField;
    cdsDetalheCOFINSOutr_vBC: TFloatField;
    cdsDetalheCOFINSOutr_pCOFINS: TFloatField;
    cdsDetalheCOFINSOutr_qBCProd: TFloatField;
    cdsDetalheCOFINSOutr_vAliqProd: TFloatField;
    cdsDetalheCOFINSOutr_vCOFINS: TFloatField;
    cdsDetalheCOFINSST_vBC: TFloatField;
    cdsDetalhepCOFINS: TFloatField;
    cdsDetalheCOFINSST_qBCProd: TFloatField;
    cdsDetalheCOFINSST_vAliqProd: TFloatField;
    cdsDetalhevCOFINS: TFloatField;
    cdsDetalheinfAdProd: TStringField;
    cdsDetalheDI: TDataSetField;
    dsDetalhe: TDataSource;
    cdsDeclaracaoImportacao: TClientDataSet;
    cdsDeclaracaoImportacaonDI: TStringField;
    cdsDeclaracaoImportacaodDI: TDateField;
    cdsDeclaracaoImportacaoxLocDesemb: TStringField;
    cdsDeclaracaoImportacaoUFDesemb: TStringField;
    cdsDeclaracaoImportacaodDesemb: TDateField;
    cdsDeclaracaoImportacaocExportador: TStringField;
    cdsDeclaracaoImportacaoadi: TDataSetField;
    dsDeclaracaoImportacao: TDataSource;
    cdsAdicoes: TClientDataSet;
    cdsAdicoesnAdicao: TIntegerField;
    cdsAdicoesnSeqAdic: TIntegerField;
    cdsAdicoescFabricante: TStringField;
    cdsAdicoesvDescDI: TFloatField;
    dsAdicoes: TDataSource;
    mItensNota: TClientDataSet;
    mItensNotaItem: TIntegerField;
    mItensNotaCodProduto: TStringField;
    mItensNotaCodProdutoInterno: TIntegerField;
    mItensNotaCodCor: TIntegerField;
    mItensNotaCodGrade: TIntegerField;
    mItensNotaPosicao: TIntegerField;
    mItensNotaTamanho: TStringField;
    mItensNotaNomeCor: TStringField;
    mItensNotaQtd: TFloatField;
    mItensNotaVlrUnitario: TFloatField;
    mItensNotaVlrTotal: TFloatField;
    mItensNotaAliqIcms: TFloatField;
    mItensNotaAliqIPI: TFloatField;
    mItensNotaCodSitTrib: TStringField;
    mItensNotaCodSitTribInterno: TIntegerField;
    mItensNotaCodCSTIPI: TStringField;
    mItensNotaCodCofins: TStringField;
    mItensNotaCodPIS: TStringField;
    mItensNotaAliqPIS: TFloatField;
    mItensNotaAliqCofins: TFloatField;
    mItensNotaVlrPis: TFloatField;
    mItensNotaVlrIcms: TFloatField;
    mItensNotaVlrCofins: TFloatField;
    mItensNotaVlrIPI: TFloatField;
    mItensNotaBaseIcms: TFloatField;
    mItensNotaUnidade: TStringField;
    mItensNotaNumPedido: TStringField;
    mItensNotaItemPedido: TIntegerField;
    mItensNotaCodBarra: TStringField;
    mItensNotaGravarNovo: TBooleanField;
    mItensNotaPercRedIcms: TFloatField;
    mItensNotaCodFornecedor: TIntegerField;
    mItensNotaNomeProduto: TStringField;
    mItensNotaNCM: TStringField;
    mItensNotaCFOP: TStringField;
    mItensNotaCFOPInterno: TStringField;
    mItensNotaBaseCSTRet: TFloatField;
    mItensNotaVlrIcmsCSTRet: TFloatField;
    mItensNotaModICMS: TStringField;
    mItensNotaOrigem: TStringField;
    mItensNotaModIcmsST: TStringField;
    mItensNotaPercMVAST: TFloatField;
    mItensNotaPercRedBCST: TFloatField;
    mItensNotaBaseCST: TFloatField;
    mItensNotaPercIcmsST: TFloatField;
    mItensNotaVlrIcmsST: TFloatField;
    mItensNotaVlrDesconto: TFloatField;
    mItensNotaProdMat: TStringField;
    mItensNotaVlrFrete: TFloatField;
    mItensNotaInfAdicionais: TStringField;
    mItensNotaNumLote: TStringField;
    mItensNotaQtdPacote: TFloatField;
    mItensNotaMercado: TStringField;
    mItensNotaCFOPOriginal: TStringField;
    mItensNotaConversorUnidade: TFloatField;
    dsmItensNota: TDataSource;
    sdsProduto: TSQLDataSet;
    dspProduto: TDataSetProvider;
    cdsProduto: TClientDataSet;
    dsProduto: TDataSource;
    sdsProdutoID: TIntegerField;
    sdsProdutoREFERENCIA: TStringField;
    sdsProdutoNOME: TStringField;
    sdsProdutoPESOLIQUIDO: TFloatField;
    sdsProdutoPESOBRUTO: TFloatField;
    sdsProdutoINATIVO: TStringField;
    sdsProdutoID_CSTIPI: TIntegerField;
    sdsProdutoPERC_IPI: TFloatField;
    sdsProdutoPRECO_CUSTO: TFloatField;
    sdsProdutoPRECO_VENDA: TFloatField;
    sdsProdutoTIPO_REG: TStringField;
    sdsProdutoPOSSE_MATERIAL: TStringField;
    sdsProdutoESTOQUE: TStringField;
    sdsProdutoMATERIAL_OUTROS: TStringField;
    sdsProdutoUSUARIO: TStringField;
    sdsProdutoDTCAD: TDateField;
    sdsProdutoHRCAD: TTimeField;
    sdsProdutoCA: TStringField;
    sdsProdutoCOMPLEMENTO: TStringField;
    sdsProdutoID_NCM: TIntegerField;
    sdsProdutoORIGEM_PROD: TStringField;
    sdsProdutoOBS: TMemoField;
    sdsProdutoCODSITCF: TStringField;
    sdsProdutoPERC_REDUCAOICMS: TFloatField;
    sdsProdutoTIPO_VENDA: TStringField;
    sdsProdutoPERC_MARGEMLUCRO: TFloatField;
    sdsProdutoUNIDADE: TStringField;
    cdsProdutoID: TIntegerField;
    cdsProdutoREFERENCIA: TStringField;
    cdsProdutoNOME: TStringField;
    cdsProdutoPESOLIQUIDO: TFloatField;
    cdsProdutoPESOBRUTO: TFloatField;
    cdsProdutoINATIVO: TStringField;
    cdsProdutoID_CSTIPI: TIntegerField;
    cdsProdutoPERC_IPI: TFloatField;
    cdsProdutoPRECO_CUSTO: TFloatField;
    cdsProdutoPRECO_VENDA: TFloatField;
    cdsProdutoTIPO_REG: TStringField;
    cdsProdutoPOSSE_MATERIAL: TStringField;
    cdsProdutoESTOQUE: TStringField;
    cdsProdutoMATERIAL_OUTROS: TStringField;
    cdsProdutoUSUARIO: TStringField;
    cdsProdutoDTCAD: TDateField;
    cdsProdutoHRCAD: TTimeField;
    cdsProdutoCA: TStringField;
    cdsProdutoCOMPLEMENTO: TStringField;
    cdsProdutoID_NCM: TIntegerField;
    cdsProdutoORIGEM_PROD: TStringField;
    cdsProdutoOBS: TMemoField;
    cdsProdutoCODSITCF: TStringField;
    cdsProdutoPERC_REDUCAOICMS: TFloatField;
    cdsProdutoTIPO_VENDA: TStringField;
    cdsProdutoPERC_MARGEMLUCRO: TFloatField;
    cdsProdutoUNIDADE: TStringField;
    qCFOP: TSQLQuery;
    qCFOPID: TIntegerField;
    qCFOPCODCFOP: TStringField;
    qCFOPNOME: TStringField;
    qCFOPENTRADASAIDA: TStringField;
    qCFOPGERAR_IPI: TStringField;
    qCFOPGERAR_ICMS: TStringField;
    qCFOPGERAR_DUPLICATA: TStringField;
    qCFOPSOMAR_VLRTOTALPRODUTO: TStringField;
    qCFOPNOME_INTERNO: TStringField;
    qCFOPID_CSTICMS: TIntegerField;
    qCFOPID_CSTIPI: TIntegerField;
    qCFOPCOPIARNOTATRIANGULAR: TStringField;
    qCFOPID_PIS: TIntegerField;
    qCFOPID_COFINS: TIntegerField;
    qCFOPTIPO_PIS: TStringField;
    qCFOPTIPO_COFINS: TStringField;
    qCFOPGERAR_ICMS_SIMPLES: TStringField;
    qCFOPTIPO_EMPRESA: TStringField;
    qCFOPSUBSTITUICAO_TRIB: TStringField;
    qCFOPMVA: TStringField;
    qCFOPPERC_COFINS: TFloatField;
    qCFOPPERC_PIS: TFloatField;
    qCFOPLEI: TMemoField;
    qCFOPBENEFICIAMENTO: TStringField;
    qParametros: TSQLQuery;
    qParametrosID: TIntegerField;
    qParametrosENDXMLNFE: TStringField;
    qParametrosENDPDFNFE: TStringField;
    qParametrosSERIENORMAL: TStringField;
    qParametrosSERIECONTINGENCIA: TStringField;
    qParametrosLOCALSERVIDORNFE: TStringField;
    qParametrosEMAILRESPONSAVELSISTEMA: TStringField;
    qParametrosNFEPRODUCAO: TStringField;
    qParametrosANEXARDANFE: TStringField;
    qParametrosVERSAONFE: TStringField;
    qParametrosVERSAOEMISSAONFE: TStringField;
    qParametrosTIPOLOGONFE: TStringField;
    qParametrosAPLICARDESCONTONOICMS: TStringField;
    qParametrosAPLICARDESCONTONOIPI: TStringField;
    qParametrosSOMARNOPROD_FRETE: TStringField;
    qParametrosSOMARNOPROD_OUTRASDESP: TStringField;
    qParametrosSOMARNOPROD_SEGURO: TStringField;
    qParametrosAJUSTELOGONFEAUTOMATICO: TStringField;
    qParametrosINFNUMNOTAMANUAL: TStringField;
    qParametrosOPCAO_DTENTREGAPEDIDO: TStringField;
    qParametrosOBS_SIMPLES: TStringField;
    qParametrosIMP_OBSSIMPLES: TStringField;
    qParametrosIMP_REFERENCIANANOTA: TStringField;
    qParametrosENVIARNOTABENEF_NANFE: TStringField;
    qParametrosESPECIE_NOTA: TStringField;
    qParametrosMARCA_NOTA: TStringField;
    qParametrosVERSAO_BANCO: TIntegerField;
    qParametrosUSA_QTDPACOTE_NTE: TStringField;
    sdsCidade: TSQLDataSet;
    dspCidade: TDataSetProvider;
    cdsCidade: TClientDataSet;
    dsCidade: TDataSource;
    sdsCidadeID: TIntegerField;
    sdsCidadeNOME: TStringField;
    sdsCidadeUF: TStringField;
    sdsCidadeCODMUNICIPIO: TStringField;
    cdsCidadeID: TIntegerField;
    cdsCidadeNOME: TStringField;
    cdsCidadeUF: TStringField;
    cdsCidadeCODMUNICIPIO: TStringField;
    sdsPais: TSQLDataSet;
    dspPais: TDataSetProvider;
    cdsPais: TClientDataSet;
    dsPais: TDataSource;
    sdsPaisID: TIntegerField;
    sdsPaisNOME: TStringField;
    sdsPaisCODPAIS: TStringField;
    cdsPaisID: TIntegerField;
    cdsPaisNOME: TStringField;
    cdsPaisCODPAIS: TStringField;
    sdsFornecedor: TSQLDataSet;
    dspFornecedor: TDataSetProvider;
    cdsFornecedor: TClientDataSet;
    dsFornecedor: TDataSource;
    sdsFornecedorCODIGO: TIntegerField;
    sdsFornecedorNOME: TStringField;
    sdsFornecedorFANTASIA: TStringField;
    sdsFornecedorENDERECO: TStringField;
    sdsFornecedorCOMPLEMENTO_END: TStringField;
    sdsFornecedorNUM_END: TStringField;
    sdsFornecedorBAIRRO: TStringField;
    sdsFornecedorID_CIDADE: TIntegerField;
    sdsFornecedorCIDADE: TStringField;
    sdsFornecedorUF: TStringField;
    sdsFornecedorCEP: TStringField;
    sdsFornecedorDDDFONE1: TIntegerField;
    sdsFornecedorTELEFONE1: TStringField;
    sdsFornecedorDDDFONE2: TIntegerField;
    sdsFornecedorTELEFONE2: TStringField;
    sdsFornecedorDDDFAX: TIntegerField;
    sdsFornecedorFAX: TStringField;
    sdsFornecedorPESSOA: TStringField;
    sdsFornecedorCNPJ_CPF: TStringField;
    sdsFornecedorINSCR_EST: TStringField;
    sdsFornecedorENDERECO_ENT: TStringField;
    sdsFornecedorCOMPLEMENTO_END_ENT: TStringField;
    sdsFornecedorNUM_END_ENT: TStringField;
    sdsFornecedorBAIRRO_ENT: TStringField;
    sdsFornecedorID_CIDADE_ENT: TIntegerField;
    sdsFornecedorCIDADE_ENT: TStringField;
    sdsFornecedorCEP_ENT: TStringField;
    sdsFornecedorUF_ENT: TStringField;
    sdsFornecedorPESSOA_ENT: TStringField;
    sdsFornecedorCNPJ_CPF_ENT: TStringField;
    sdsFornecedorINSC_EST_ENT: TStringField;
    sdsFornecedorENDERECO_PGTO: TStringField;
    sdsFornecedorCOMPLEMENTO_END_PGTO: TStringField;
    sdsFornecedorNUM_END_PGTO: TStringField;
    sdsFornecedorBAIRRO_PGTO: TStringField;
    sdsFornecedorID_CIDADE_PGTO: TIntegerField;
    sdsFornecedorCIDADE_PGTO: TStringField;
    sdsFornecedorCEP_PGTO: TStringField;
    sdsFornecedorUF_PGTO: TStringField;
    sdsFornecedorUSUARIO: TStringField;
    sdsFornecedorDTCADASTRO: TDateField;
    sdsFornecedorHRCADASTRO: TTimeField;
    sdsFornecedorOBS: TMemoField;
    sdsFornecedorCAIXAPOSTAL: TStringField;
    sdsFornecedorRG: TStringField;
    sdsFornecedorID_VENDEDOR: TIntegerField;
    sdsFornecedorID_CONDPGTO: TIntegerField;
    sdsFornecedorID_CONTABOLETO: TIntegerField;
    sdsFornecedorID_TRANSPORTADORA: TIntegerField;
    sdsFornecedorID_TIPOCOBRANCA: TIntegerField;
    sdsFornecedorID_REDESPACHO: TIntegerField;
    sdsFornecedorID_PAIS: TIntegerField;
    sdsFornecedorID_REGIME_TRIB: TIntegerField;
    sdsFornecedorPERC_COMISSAO: TFloatField;
    sdsFornecedorDDD_ENT: TIntegerField;
    sdsFornecedorFONE_ENT: TStringField;
    sdsFornecedorDDD_PGTO: TIntegerField;
    sdsFornecedorFONE_PGTO: TStringField;
    sdsFornecedorINATIVO: TStringField;
    sdsFornecedorHOMEPAGE: TStringField;
    sdsFornecedorTIPO_FRETE: TStringField;
    sdsFornecedorNOME_ENTREGA: TStringField;
    sdsFornecedorEMAIL_NFE: TStringField;
    sdsFornecedorEMAIL_PGTO: TStringField;
    sdsFornecedorEMAIL_NFE2: TStringField;
    sdsFornecedorPESSOA_PGTO: TStringField;
    sdsFornecedorCNPJ_CPG_PGTO: TStringField;
    sdsFornecedorINSC_EST_PGTO: TStringField;
    sdsFornecedorUF_PLACA: TStringField;
    sdsFornecedorPLACA: TStringField;
    sdsFornecedorTP_CLIENTE: TStringField;
    sdsFornecedorTP_FORNECEDOR: TStringField;
    sdsFornecedorTP_TRANSPORTADORA: TStringField;
    sdsFornecedorTP_VENDEDOR: TStringField;
    cdsFornecedorCODIGO: TIntegerField;
    cdsFornecedorNOME: TStringField;
    cdsFornecedorFANTASIA: TStringField;
    cdsFornecedorENDERECO: TStringField;
    cdsFornecedorCOMPLEMENTO_END: TStringField;
    cdsFornecedorNUM_END: TStringField;
    cdsFornecedorBAIRRO: TStringField;
    cdsFornecedorID_CIDADE: TIntegerField;
    cdsFornecedorCIDADE: TStringField;
    cdsFornecedorUF: TStringField;
    cdsFornecedorCEP: TStringField;
    cdsFornecedorDDDFONE1: TIntegerField;
    cdsFornecedorTELEFONE1: TStringField;
    cdsFornecedorDDDFONE2: TIntegerField;
    cdsFornecedorTELEFONE2: TStringField;
    cdsFornecedorDDDFAX: TIntegerField;
    cdsFornecedorFAX: TStringField;
    cdsFornecedorPESSOA: TStringField;
    cdsFornecedorCNPJ_CPF: TStringField;
    cdsFornecedorINSCR_EST: TStringField;
    cdsFornecedorENDERECO_ENT: TStringField;
    cdsFornecedorCOMPLEMENTO_END_ENT: TStringField;
    cdsFornecedorNUM_END_ENT: TStringField;
    cdsFornecedorBAIRRO_ENT: TStringField;
    cdsFornecedorID_CIDADE_ENT: TIntegerField;
    cdsFornecedorCIDADE_ENT: TStringField;
    cdsFornecedorCEP_ENT: TStringField;
    cdsFornecedorUF_ENT: TStringField;
    cdsFornecedorPESSOA_ENT: TStringField;
    cdsFornecedorCNPJ_CPF_ENT: TStringField;
    cdsFornecedorINSC_EST_ENT: TStringField;
    cdsFornecedorENDERECO_PGTO: TStringField;
    cdsFornecedorCOMPLEMENTO_END_PGTO: TStringField;
    cdsFornecedorNUM_END_PGTO: TStringField;
    cdsFornecedorBAIRRO_PGTO: TStringField;
    cdsFornecedorID_CIDADE_PGTO: TIntegerField;
    cdsFornecedorCIDADE_PGTO: TStringField;
    cdsFornecedorCEP_PGTO: TStringField;
    cdsFornecedorUF_PGTO: TStringField;
    cdsFornecedorUSUARIO: TStringField;
    cdsFornecedorDTCADASTRO: TDateField;
    cdsFornecedorHRCADASTRO: TTimeField;
    cdsFornecedorOBS: TMemoField;
    cdsFornecedorCAIXAPOSTAL: TStringField;
    cdsFornecedorRG: TStringField;
    cdsFornecedorID_VENDEDOR: TIntegerField;
    cdsFornecedorID_CONDPGTO: TIntegerField;
    cdsFornecedorID_CONTABOLETO: TIntegerField;
    cdsFornecedorID_TRANSPORTADORA: TIntegerField;
    cdsFornecedorID_TIPOCOBRANCA: TIntegerField;
    cdsFornecedorID_REDESPACHO: TIntegerField;
    cdsFornecedorID_PAIS: TIntegerField;
    cdsFornecedorID_REGIME_TRIB: TIntegerField;
    cdsFornecedorPERC_COMISSAO: TFloatField;
    cdsFornecedorDDD_ENT: TIntegerField;
    cdsFornecedorFONE_ENT: TStringField;
    cdsFornecedorDDD_PGTO: TIntegerField;
    cdsFornecedorFONE_PGTO: TStringField;
    cdsFornecedorINATIVO: TStringField;
    cdsFornecedorHOMEPAGE: TStringField;
    cdsFornecedorTIPO_FRETE: TStringField;
    cdsFornecedorNOME_ENTREGA: TStringField;
    cdsFornecedorEMAIL_NFE: TStringField;
    cdsFornecedorEMAIL_PGTO: TStringField;
    cdsFornecedorEMAIL_NFE2: TStringField;
    cdsFornecedorPESSOA_PGTO: TStringField;
    cdsFornecedorCNPJ_CPG_PGTO: TStringField;
    cdsFornecedorINSC_EST_PGTO: TStringField;
    cdsFornecedorUF_PLACA: TStringField;
    cdsFornecedorPLACA: TStringField;
    cdsFornecedorTP_CLIENTE: TStringField;
    cdsFornecedorTP_FORNECEDOR: TStringField;
    cdsFornecedorTP_TRANSPORTADORA: TStringField;
    cdsFornecedorTP_VENDEDOR: TStringField;
    sdsProduto_Forn: TSQLDataSet;
    dspProduto_Forn: TDataSetProvider;
    cdsProduto_Forn: TClientDataSet;
    dsProduto_Forn: TDataSource;
    sdsProduto_FornID: TIntegerField;
    sdsProduto_FornITEM: TIntegerField;
    sdsProduto_FornID_FORNECEDOR: TIntegerField;
    sdsProduto_FornNOME_MATERIAL_FORN: TStringField;
    sdsProduto_FornTAMANHO: TStringField;
    sdsProduto_FornID_COR: TIntegerField;
    sdsProduto_FornCOD_BARRA: TStringField;
    cdsProduto_FornID: TIntegerField;
    cdsProduto_FornITEM: TIntegerField;
    cdsProduto_FornID_FORNECEDOR: TIntegerField;
    cdsProduto_FornNOME_MATERIAL_FORN: TStringField;
    cdsProduto_FornTAMANHO: TStringField;
    cdsProduto_FornID_COR: TIntegerField;
    cdsProduto_FornCOD_BARRA: TStringField;
    sdsNotaFiscal: TSQLDataSet;
    sdsNotaFiscalID: TIntegerField;
    sdsNotaFiscalFILIAL: TIntegerField;
    sdsNotaFiscalSERIE: TStringField;
    sdsNotaFiscalNUMNOTA: TIntegerField;
    sdsNotaFiscalDTEMISSAO: TDateField;
    sdsNotaFiscalID_CFOP: TIntegerField;
    sdsNotaFiscalID_CLIENTE: TIntegerField;
    sdsNotaFiscalID_CONDPGTO: TIntegerField;
    sdsNotaFiscalID_VENDEDOR: TIntegerField;
    sdsNotaFiscalVLR_ICMS: TFloatField;
    sdsNotaFiscalVLR_IPI: TFloatField;
    sdsNotaFiscalVLR_NOTA: TFloatField;
    sdsNotaFiscalVLR_ITENS: TFloatField;
    sdsNotaFiscalVLR_DUPLICATA: TFloatField;
    sdsNotaFiscalVLR_ENTRADA: TFloatField;
    sdsNotaFiscalPERC_DESCONTO: TFloatField;
    sdsNotaFiscalVLR_DESCONTO: TFloatField;
    sdsNotaFiscalVLR_FRETE: TFloatField;
    sdsNotaFiscalVLR_SEGURO: TFloatField;
    sdsNotaFiscalVLR_OUTRASDESP: TFloatField;
    sdsNotaFiscalBASE_ICMSTRANSF: TFloatField;
    sdsNotaFiscalPERC_TRANSF: TFloatField;
    sdsNotaFiscalVLR_TRANSF: TFloatField;
    sdsNotaFiscalVLR_PIS: TFloatField;
    sdsNotaFiscalVLR_COFINS: TFloatField;
    sdsNotaFiscalVLR_TAXACISCOMEX: TFloatField;
    sdsNotaFiscalVLR_OUTROS: TFloatField;
    sdsNotaFiscalBASE_ICMSSIMPLES: TFloatField;
    sdsNotaFiscalVLR_ICMSSIMPLES: TFloatField;
    sdsNotaFiscalPERC_ICMSSIMPLES: TFloatField;
    sdsNotaFiscalVLR_IMPORTACAO: TFloatField;
    sdsNotaFiscalBASE_ICMSSUBST: TFloatField;
    sdsNotaFiscalVLR_ICMSSUBST: TFloatField;
    sdsNotaFiscalBASE_ICMSOUTROS: TFloatField;
    sdsNotaFiscalVLR_ICMSOUTROS: TFloatField;
    sdsNotaFiscalVLR_DUPLICATAOUTROS: TFloatField;
    sdsNotaFiscalVLR_ADUANEIRA: TFloatField;
    sdsNotaFiscalPERC_ICMS_PISCOFINS: TFloatField;
    sdsNotaFiscalPERC_ICMS_OUTROSVALORES: TFloatField;
    sdsNotaFiscalPERC_ICMS_FRETE: TFloatField;
    sdsNotaFiscalPERC_DESCONTOORIG: TFloatField;
    sdsNotaFiscalQTDVOLUME: TIntegerField;
    sdsNotaFiscalESPECIE: TStringField;
    sdsNotaFiscalMARCA: TStringField;
    sdsNotaFiscalNUMEROVOLUME: TStringField;
    sdsNotaFiscalPESOBRUTO: TFloatField;
    sdsNotaFiscalPESOLIQUIDO: TFloatField;
    sdsNotaFiscalPLACA: TStringField;
    sdsNotaFiscalUFPLACA: TStringField;
    sdsNotaFiscalTIPO_FRETE: TStringField;
    sdsNotaFiscalID_TRANSPORTADORA: TIntegerField;
    sdsNotaFiscalID_REDESPACHO: TIntegerField;
    sdsNotaFiscalCANCELADA: TStringField;
    sdsNotaFiscalMOTIVO_CANCELADA: TStringField;
    sdsNotaFiscalDTSAIDAENTRADA: TDateField;
    sdsNotaFiscalHRSAIDAENTRADA: TTimeField;
    sdsNotaFiscalID_BANCO: TIntegerField;
    sdsNotaFiscalLOCALENTREGA: TStringField;
    sdsNotaFiscalID_EXTCOMISSAO: TIntegerField;
    sdsNotaFiscalDESCRICAO_DESC: TStringField;
    sdsNotaFiscalID_CLIENTETRIANG: TIntegerField;
    sdsNotaFiscalQTDTOTAL_ITENS: TIntegerField;
    sdsNotaFiscalNFERECIBO: TStringField;
    sdsNotaFiscalNFEPROTOCOLO: TStringField;
    sdsNotaFiscalNFECHAVEACESSO: TStringField;
    sdsNotaFiscalNFEPROTOCOLO_CANCELADA: TStringField;
    sdsNotaFiscalTIPO_ENVIONFE: TStringField;
    sdsNotaFiscalNFECODBARRA_CONTINGENCIA: TStringField;
    sdsNotaFiscalNFEVERSAO: TStringField;
    sdsNotaFiscalNFEFINALIDADE: TStringField;
    sdsNotaFiscalNFEAMBIENTE: TStringField;
    sdsNotaFiscalNUMNOTACOPIADA: TIntegerField;
    sdsNotaFiscalSERIECOPIADA: TStringField;
    sdsNotaFiscalDTCONTINGENCIA: TDateField;
    sdsNotaFiscalHRCONTINGENCIA: TTimeField;
    sdsNotaFiscalMOTIVO_CONTINGENCIA: TStringField;
    sdsNotaFiscalNFEVERSAOEMISSAO: TStringField;
    sdsNotaFiscalID_REGIMETRIB: TIntegerField;
    sdsNotaFiscalRNTC: TStringField;
    sdsNotaFiscalVAGAOBALSA_IDENTIF: TStringField;
    sdsNotaFiscalVAGAOBALSA_TIPOIDENTIF: TStringField;
    sdsNotaFiscalUFEMBEXPORTACAO: TStringField;
    sdsNotaFiscalLOCALEMBEXPORTACAO: TStringField;
    sdsNotaFiscalPISCOFINS_SOMAROUTRASDESP: TStringField;
    sdsNotaFiscalGERARDUPL_OUTROSVALORES: TStringField;
    sdsNotaFiscalGERARDUPL_FRETE: TStringField;
    sdsNotaFiscalGERARDUPL_SEGURO: TStringField;
    sdsNotaFiscalINFORMADO_NUMNOTAMANUAL: TStringField;
    sdsNotaFiscalNFEDENEGADA: TStringField;
    sdsNotaFiscalMOTIVO_DENEGADA: TStringField;
    sdsNotaFiscalDADOS_ADICIONAIS: TMemoField;
    sdsNotaFiscalBASE_ICMS: TFloatField;
    sdsNotaFiscalDTINICIO_DUPLICATA: TDateField;
    sdsNotaFiscalTIPO_DESCONTO: TStringField;
    sdsNotaFiscalTIPO_PRAZO: TStringField;
    sdsNotaFiscalPERC_COMISSAO: TFloatField;
    sdsNotaFiscalTIPO_NOTA: TStringField;
    sdsNotaFiscalSIMPLES_FILIAL: TStringField;
    sdsNotaFiscalTIPO_REG: TStringField;
    dspNotaFiscal: TDataSetProvider;
    cdsNotaFiscal: TClientDataSet;
    cdsNotaFiscalFILIAL: TIntegerField;
    cdsNotaFiscalID: TIntegerField;
    cdsNotaFiscalSERIE: TStringField;
    cdsNotaFiscalNUMNOTA: TIntegerField;
    cdsNotaFiscalDTEMISSAO: TDateField;
    cdsNotaFiscalID_CFOP: TIntegerField;
    cdsNotaFiscalID_CLIENTE: TIntegerField;
    cdsNotaFiscalID_CONDPGTO: TIntegerField;
    cdsNotaFiscalID_VENDEDOR: TIntegerField;
    cdsNotaFiscalVLR_ICMS: TFloatField;
    cdsNotaFiscalVLR_IPI: TFloatField;
    cdsNotaFiscalVLR_NOTA: TFloatField;
    cdsNotaFiscalVLR_ITENS: TFloatField;
    cdsNotaFiscalVLR_DUPLICATA: TFloatField;
    cdsNotaFiscalVLR_ENTRADA: TFloatField;
    cdsNotaFiscalPERC_DESCONTO: TFloatField;
    cdsNotaFiscalVLR_DESCONTO: TFloatField;
    cdsNotaFiscalVLR_FRETE: TFloatField;
    cdsNotaFiscalVLR_SEGURO: TFloatField;
    cdsNotaFiscalVLR_OUTRASDESP: TFloatField;
    cdsNotaFiscalBASE_ICMSTRANSF: TFloatField;
    cdsNotaFiscalPERC_TRANSF: TFloatField;
    cdsNotaFiscalVLR_TRANSF: TFloatField;
    cdsNotaFiscalVLR_PIS: TFloatField;
    cdsNotaFiscalVLR_COFINS: TFloatField;
    cdsNotaFiscalVLR_TAXACISCOMEX: TFloatField;
    cdsNotaFiscalVLR_OUTROS: TFloatField;
    cdsNotaFiscalBASE_ICMSSIMPLES: TFloatField;
    cdsNotaFiscalVLR_ICMSSIMPLES: TFloatField;
    cdsNotaFiscalPERC_ICMSSIMPLES: TFloatField;
    cdsNotaFiscalVLR_IMPORTACAO: TFloatField;
    cdsNotaFiscalBASE_ICMSSUBST: TFloatField;
    cdsNotaFiscalVLR_ICMSSUBST: TFloatField;
    cdsNotaFiscalBASE_ICMSOUTROS: TFloatField;
    cdsNotaFiscalVLR_ICMSOUTROS: TFloatField;
    cdsNotaFiscalVLR_DUPLICATAOUTROS: TFloatField;
    cdsNotaFiscalVLR_ADUANEIRA: TFloatField;
    cdsNotaFiscalPERC_ICMS_PISCOFINS: TFloatField;
    cdsNotaFiscalPERC_ICMS_OUTROSVALORES: TFloatField;
    cdsNotaFiscalPERC_ICMS_FRETE: TFloatField;
    cdsNotaFiscalPERC_DESCONTOORIG: TFloatField;
    cdsNotaFiscalQTDVOLUME: TIntegerField;
    cdsNotaFiscalESPECIE: TStringField;
    cdsNotaFiscalMARCA: TStringField;
    cdsNotaFiscalNUMEROVOLUME: TStringField;
    cdsNotaFiscalPESOBRUTO: TFloatField;
    cdsNotaFiscalPESOLIQUIDO: TFloatField;
    cdsNotaFiscalPLACA: TStringField;
    cdsNotaFiscalUFPLACA: TStringField;
    cdsNotaFiscalTIPO_FRETE: TStringField;
    cdsNotaFiscalID_TRANSPORTADORA: TIntegerField;
    cdsNotaFiscalID_REDESPACHO: TIntegerField;
    cdsNotaFiscalCANCELADA: TStringField;
    cdsNotaFiscalMOTIVO_CANCELADA: TStringField;
    cdsNotaFiscalDTSAIDAENTRADA: TDateField;
    cdsNotaFiscalHRSAIDAENTRADA: TTimeField;
    cdsNotaFiscalID_BANCO: TIntegerField;
    cdsNotaFiscalLOCALENTREGA: TStringField;
    cdsNotaFiscalID_EXTCOMISSAO: TIntegerField;
    cdsNotaFiscalDESCRICAO_DESC: TStringField;
    cdsNotaFiscalID_CLIENTETRIANG: TIntegerField;
    cdsNotaFiscalQTDTOTAL_ITENS: TIntegerField;
    cdsNotaFiscalNFERECIBO: TStringField;
    cdsNotaFiscalNFEPROTOCOLO: TStringField;
    cdsNotaFiscalNFECHAVEACESSO: TStringField;
    cdsNotaFiscalNFEPROTOCOLO_CANCELADA: TStringField;
    cdsNotaFiscalTIPO_ENVIONFE: TStringField;
    cdsNotaFiscalNFECODBARRA_CONTINGENCIA: TStringField;
    cdsNotaFiscalNFEVERSAO: TStringField;
    cdsNotaFiscalNFEFINALIDADE: TStringField;
    cdsNotaFiscalNFEAMBIENTE: TStringField;
    cdsNotaFiscalNUMNOTACOPIADA: TIntegerField;
    cdsNotaFiscalSERIECOPIADA: TStringField;
    cdsNotaFiscalDTCONTINGENCIA: TDateField;
    cdsNotaFiscalHRCONTINGENCIA: TTimeField;
    cdsNotaFiscalMOTIVO_CONTINGENCIA: TStringField;
    cdsNotaFiscalNFEVERSAOEMISSAO: TStringField;
    cdsNotaFiscalID_REGIMETRIB: TIntegerField;
    cdsNotaFiscalRNTC: TStringField;
    cdsNotaFiscalVAGAOBALSA_IDENTIF: TStringField;
    cdsNotaFiscalVAGAOBALSA_TIPOIDENTIF: TStringField;
    cdsNotaFiscalUFEMBEXPORTACAO: TStringField;
    cdsNotaFiscalLOCALEMBEXPORTACAO: TStringField;
    cdsNotaFiscalPISCOFINS_SOMAROUTRASDESP: TStringField;
    cdsNotaFiscalGERARDUPL_OUTROSVALORES: TStringField;
    cdsNotaFiscalGERARDUPL_FRETE: TStringField;
    cdsNotaFiscalGERARDUPL_SEGURO: TStringField;
    cdsNotaFiscalINFORMADO_NUMNOTAMANUAL: TStringField;
    cdsNotaFiscalNFEDENEGADA: TStringField;
    cdsNotaFiscalMOTIVO_DENEGADA: TStringField;
    cdsNotaFiscalDADOS_ADICIONAIS: TMemoField;
    cdsNotaFiscalBASE_ICMS: TFloatField;
    cdsNotaFiscalDTINICIO_DUPLICATA: TDateField;
    cdsNotaFiscalTIPO_DESCONTO: TStringField;
    cdsNotaFiscalTIPO_PRAZO: TStringField;
    cdsNotaFiscalPERC_COMISSAO: TFloatField;
    cdsNotaFiscalTIPO_NOTA: TStringField;
    cdsNotaFiscalSIMPLES_FILIAL: TStringField;
    cdsNotaFiscalTIPO_REG: TStringField;
    dsNotaFiscal: TDataSource;
    dsNotaFiscal_Mestre: TDataSource;
    sdsNotaFiscal_Itens: TSQLDataSet;
    cdsNotaFiscal_Itens: TClientDataSet;
    dsNotaFiscal_Itens: TDataSource;
    cdsNotaFiscalsdsNotaFiscal_Itens: TDataSetField;
    sdsNotaFiscal_ItensID: TIntegerField;
    sdsNotaFiscal_ItensITEM: TIntegerField;
    sdsNotaFiscal_ItensID_PRODUTO: TIntegerField;
    sdsNotaFiscal_ItensID_COR: TIntegerField;
    sdsNotaFiscal_ItensTAMANHO: TStringField;
    sdsNotaFiscal_ItensID_NCM: TIntegerField;
    sdsNotaFiscal_ItensUNIDADE: TStringField;
    sdsNotaFiscal_ItensQTD: TFloatField;
    sdsNotaFiscal_ItensID_CFOP: TIntegerField;
    sdsNotaFiscal_ItensID_CSTICMS: TIntegerField;
    sdsNotaFiscal_ItensID_CSTIPI: TIntegerField;
    sdsNotaFiscal_ItensID_PIS: TIntegerField;
    sdsNotaFiscal_ItensID_COFINS: TIntegerField;
    sdsNotaFiscal_ItensPERC_ICMS: TFloatField;
    sdsNotaFiscal_ItensPERC_IPI: TFloatField;
    sdsNotaFiscal_ItensVLR_UNITARIO: TFloatField;
    sdsNotaFiscal_ItensVLR_TOTAL: TFloatField;
    sdsNotaFiscal_ItensPERC_DESCONTO: TFloatField;
    sdsNotaFiscal_ItensVLR_DESCONTO: TFloatField;
    sdsNotaFiscal_ItensBASE_ICMS: TFloatField;
    sdsNotaFiscal_ItensVLR_ICMS: TFloatField;
    sdsNotaFiscal_ItensVLR_IPI: TFloatField;
    sdsNotaFiscal_ItensPERC_PIS: TFloatField;
    sdsNotaFiscal_ItensPERC_COFINS: TFloatField;
    sdsNotaFiscal_ItensVLR_PIS: TFloatField;
    sdsNotaFiscal_ItensVLR_COFINS: TFloatField;
    sdsNotaFiscal_ItensTIPO_PIS: TStringField;
    sdsNotaFiscal_ItensTIPO_COFINS: TStringField;
    sdsNotaFiscal_ItensORIGEM_PROD: TStringField;
    sdsNotaFiscal_ItensBASE_ICMSSIMPLES: TFloatField;
    sdsNotaFiscal_ItensVLR_ICMSSIMPLES: TFloatField;
    sdsNotaFiscal_ItensCALCULARICMSSOBREIPI: TStringField;
    sdsNotaFiscal_ItensNOME_PRODUTO: TStringField;
    sdsNotaFiscal_ItensREFERENCIA: TStringField;
    sdsNotaFiscal_ItensID_MOVESTOQUE: TIntegerField;
    sdsNotaFiscal_ItensGERAR_DUPLICATA: TStringField;
    sdsNotaFiscal_ItensGERAR_ESTOQUE: TStringField;
    sdsNotaFiscal_ItensNUMERO_OC: TStringField;
    sdsNotaFiscal_ItensNUMERO_OS: TStringField;
    sdsNotaFiscal_ItensITEM_PEDIDO: TIntegerField;
    sdsNotaFiscal_ItensPERC_COMISSAO: TFloatField;
    sdsNotaFiscal_ItensQTDRESTANTE: TFloatField;
    sdsNotaFiscal_ItensQTDDEVOLVIDA: TFloatField;
    sdsNotaFiscal_ItensSOMAR_TRANSF_ICMS: TStringField;
    sdsNotaFiscal_ItensOBS_COMPLEMENTAR: TStringField;
    sdsNotaFiscal_ItensSOMAR_VLRTOTALPRODUTO: TStringField;
    sdsNotaFiscal_ItensVLR_FRETE: TFloatField;
    sdsNotaFiscal_ItensVLR_OUTRASDESPESAS: TFloatField;
    sdsNotaFiscal_ItensVLR_SEGURO: TFloatField;
    sdsNotaFiscal_ItensVLR_ICMSFRETE: TFloatField;
    sdsNotaFiscal_ItensVLR_ICMSOUTRASDESPESAS: TFloatField;
    sdsNotaFiscal_ItensBASE_ICMSSUBST: TFloatField;
    sdsNotaFiscal_ItensVLR_ICMSSUBST: TFloatField;
    sdsNotaFiscal_ItensVLR_IMPORTACAO: TFloatField;
    sdsNotaFiscal_ItensVLR_ADUANEIRA: TFloatField;
    sdsNotaFiscal_ItensVLR_DESCONTORATEIO: TFloatField;
    sdsNotaFiscal_ItensQTD_ADEVOLVER: TFloatField;
    cdsNotaFiscal_ItensID: TIntegerField;
    cdsNotaFiscal_ItensITEM: TIntegerField;
    cdsNotaFiscal_ItensID_PRODUTO: TIntegerField;
    cdsNotaFiscal_ItensID_COR: TIntegerField;
    cdsNotaFiscal_ItensTAMANHO: TStringField;
    cdsNotaFiscal_ItensID_NCM: TIntegerField;
    cdsNotaFiscal_ItensUNIDADE: TStringField;
    cdsNotaFiscal_ItensQTD: TFloatField;
    cdsNotaFiscal_ItensID_CFOP: TIntegerField;
    cdsNotaFiscal_ItensID_CSTICMS: TIntegerField;
    cdsNotaFiscal_ItensID_CSTIPI: TIntegerField;
    cdsNotaFiscal_ItensID_PIS: TIntegerField;
    cdsNotaFiscal_ItensID_COFINS: TIntegerField;
    cdsNotaFiscal_ItensPERC_ICMS: TFloatField;
    cdsNotaFiscal_ItensPERC_IPI: TFloatField;
    cdsNotaFiscal_ItensVLR_UNITARIO: TFloatField;
    cdsNotaFiscal_ItensVLR_TOTAL: TFloatField;
    cdsNotaFiscal_ItensPERC_DESCONTO: TFloatField;
    cdsNotaFiscal_ItensVLR_DESCONTO: TFloatField;
    cdsNotaFiscal_ItensBASE_ICMS: TFloatField;
    cdsNotaFiscal_ItensVLR_ICMS: TFloatField;
    cdsNotaFiscal_ItensVLR_IPI: TFloatField;
    cdsNotaFiscal_ItensPERC_PIS: TFloatField;
    cdsNotaFiscal_ItensPERC_COFINS: TFloatField;
    cdsNotaFiscal_ItensVLR_PIS: TFloatField;
    cdsNotaFiscal_ItensVLR_COFINS: TFloatField;
    cdsNotaFiscal_ItensTIPO_PIS: TStringField;
    cdsNotaFiscal_ItensTIPO_COFINS: TStringField;
    cdsNotaFiscal_ItensORIGEM_PROD: TStringField;
    cdsNotaFiscal_ItensBASE_ICMSSIMPLES: TFloatField;
    cdsNotaFiscal_ItensVLR_ICMSSIMPLES: TFloatField;
    cdsNotaFiscal_ItensCALCULARICMSSOBREIPI: TStringField;
    cdsNotaFiscal_ItensNOME_PRODUTO: TStringField;
    cdsNotaFiscal_ItensREFERENCIA: TStringField;
    cdsNotaFiscal_ItensID_MOVESTOQUE: TIntegerField;
    cdsNotaFiscal_ItensGERAR_DUPLICATA: TStringField;
    cdsNotaFiscal_ItensGERAR_ESTOQUE: TStringField;
    cdsNotaFiscal_ItensNUMERO_OC: TStringField;
    cdsNotaFiscal_ItensNUMERO_OS: TStringField;
    cdsNotaFiscal_ItensITEM_PEDIDO: TIntegerField;
    cdsNotaFiscal_ItensPERC_COMISSAO: TFloatField;
    cdsNotaFiscal_ItensQTDRESTANTE: TFloatField;
    cdsNotaFiscal_ItensQTDDEVOLVIDA: TFloatField;
    cdsNotaFiscal_ItensSOMAR_TRANSF_ICMS: TStringField;
    cdsNotaFiscal_ItensOBS_COMPLEMENTAR: TStringField;
    cdsNotaFiscal_ItensSOMAR_VLRTOTALPRODUTO: TStringField;
    cdsNotaFiscal_ItensVLR_FRETE: TFloatField;
    cdsNotaFiscal_ItensVLR_OUTRASDESPESAS: TFloatField;
    cdsNotaFiscal_ItensVLR_SEGURO: TFloatField;
    cdsNotaFiscal_ItensVLR_ICMSFRETE: TFloatField;
    cdsNotaFiscal_ItensVLR_ICMSOUTRASDESPESAS: TFloatField;
    cdsNotaFiscal_ItensBASE_ICMSSUBST: TFloatField;
    cdsNotaFiscal_ItensVLR_ICMSSUBST: TFloatField;
    cdsNotaFiscal_ItensVLR_IMPORTACAO: TFloatField;
    cdsNotaFiscal_ItensVLR_ADUANEIRA: TFloatField;
    cdsNotaFiscal_ItensVLR_DESCONTORATEIO: TFloatField;
    cdsNotaFiscal_ItensQTD_ADEVOLVER: TFloatField;
    sdsNotaFiscal_ItensQTD_PACOTE: TFloatField;
    cdsNotaFiscal_ItensQTD_PACOTE: TFloatField;
    sdsEstoque_Mov: TSQLDataSet;
    dspEstoque_Mov: TDataSetProvider;
    cdsEstoque_Mov: TClientDataSet;
    dsEstoque_Mov: TDataSource;
    sdsEstoque_MovID: TIntegerField;
    sdsEstoque_MovFILIAL: TIntegerField;
    sdsEstoque_MovID_PRODUTO: TIntegerField;
    sdsEstoque_MovID_COR: TIntegerField;
    sdsEstoque_MovDTMOVIMENTO: TDateField;
    sdsEstoque_MovTIPO_ES: TStringField;
    sdsEstoque_MovTIPO_MOV: TStringField;
    sdsEstoque_MovNUMNOTA: TIntegerField;
    sdsEstoque_MovID_PESSOA: TIntegerField;
    sdsEstoque_MovVLR_UNITARIO: TFloatField;
    sdsEstoque_MovQTD: TFloatField;
    sdsEstoque_MovPERC_ICMS: TFloatField;
    sdsEstoque_MovPERC_IPI: TFloatField;
    sdsEstoque_MovVLR_DESCONTO: TFloatField;
    sdsEstoque_MovUNIDADE: TStringField;
    sdsEstoque_MovQTD2: TFloatField;
    sdsEstoque_MovTAMANHO: TStringField;
    sdsEstoque_MovPERC_TRIBUTACAO: TFloatField;
    sdsEstoque_MovVLR_FRETE: TFloatField;
    sdsEstoque_MovID_CFOP: TIntegerField;
    sdsEstoque_MovID_NOTA: TIntegerField;
    sdsEstoque_MovSERIE: TStringField;
    sdsEstoque_MovUNIDADE_ORIG: TStringField;
    sdsEstoque_MovVLR_UNITARIOORIG: TFloatField;
    sdsEstoque_MovQTD_ORIG: TFloatField;
    sdsEstoque_MovVLR_DESCONTOORIG: TFloatField;
    sdsEstoque_MovMERCADO: TStringField;
    cdsEstoque_MovID: TIntegerField;
    cdsEstoque_MovFILIAL: TIntegerField;
    cdsEstoque_MovID_PRODUTO: TIntegerField;
    cdsEstoque_MovID_COR: TIntegerField;
    cdsEstoque_MovDTMOVIMENTO: TDateField;
    cdsEstoque_MovTIPO_ES: TStringField;
    cdsEstoque_MovTIPO_MOV: TStringField;
    cdsEstoque_MovNUMNOTA: TIntegerField;
    cdsEstoque_MovID_PESSOA: TIntegerField;
    cdsEstoque_MovVLR_UNITARIO: TFloatField;
    cdsEstoque_MovQTD: TFloatField;
    cdsEstoque_MovPERC_ICMS: TFloatField;
    cdsEstoque_MovPERC_IPI: TFloatField;
    cdsEstoque_MovVLR_DESCONTO: TFloatField;
    cdsEstoque_MovUNIDADE: TStringField;
    cdsEstoque_MovQTD2: TFloatField;
    cdsEstoque_MovTAMANHO: TStringField;
    cdsEstoque_MovPERC_TRIBUTACAO: TFloatField;
    cdsEstoque_MovVLR_FRETE: TFloatField;
    cdsEstoque_MovID_CFOP: TIntegerField;
    cdsEstoque_MovID_NOTA: TIntegerField;
    cdsEstoque_MovSERIE: TStringField;
    cdsEstoque_MovUNIDADE_ORIG: TStringField;
    cdsEstoque_MovVLR_UNITARIOORIG: TFloatField;
    cdsEstoque_MovQTD_ORIG: TFloatField;
    cdsEstoque_MovVLR_DESCONTOORIG: TFloatField;
    cdsEstoque_MovMERCADO: TStringField;
    mItensNotaID_NCM: TIntegerField;
    sdsTab_CSTICMS: TSQLDataSet;
    dspTab_CSTICMS: TDataSetProvider;
    cdsTab_CSTICMS: TClientDataSet;
    cdsTab_CSTICMSID: TIntegerField;
    cdsTab_CSTICMSPERCENTUAL: TFloatField;
    cdsTab_CSTICMSHISTORICO: TMemoField;
    cdsTab_CSTICMSTIPO: TStringField;
    cdsTab_CSTICMSNOME: TStringField;
    cdsTab_CSTICMSCOD_CST: TStringField;
    dsTab_CSTICMS: TDataSource;
    qUnidade: TSQLQuery;
    qUnidadeUNIDADE: TStringField;
    qUnidadeCONVERSOR: TFloatField;
    qUnidadeNOME: TStringField;
    qFilial: TSQLQuery;
    qFilialID: TIntegerField;
    qFilialNOME: TStringField;
    qFilialNOME_INTERNO: TStringField;
    qFilialENDERECO: TStringField;
    qFilialCOMPLEMENTO_END: TStringField;
    qFilialNUM_END: TStringField;
    qFilialBAIRRO: TStringField;
    qFilialCEP: TStringField;
    qFilialID_CIDADE: TIntegerField;
    qFilialCIDADE: TStringField;
    qFilialUF: TStringField;
    qFilialDDD1: TIntegerField;
    qFilialFONE1: TStringField;
    qFilialDDD2: TIntegerField;
    qFilialFONE: TStringField;
    qFilialDDDFAX: TIntegerField;
    qFilialFAX: TStringField;
    qFilialPESSOA: TStringField;
    qFilialCNPJ_CPF: TStringField;
    qFilialINSCR_EST: TStringField;
    qFilialSIMPLES: TStringField;
    qFilialENDLOGO: TStringField;
    qFilialCALCULAR_IPI: TStringField;
    qFilialINATIVO: TStringField;
    qFilialINSCMUNICIPAL: TStringField;
    qFilialCNAE: TStringField;
    qFilialHOMEPAGE: TStringField;
    qFilialUSARICMSSIMPLES: TStringField;
    qFilialID_REGIME_TRIB: TIntegerField;
    qFilialID_PIS: TIntegerField;
    qFilialID_COFINS: TIntegerField;
    qFilialTIPO_PIS: TStringField;
    qFilialTIPO_COFINS: TStringField;
    qFilialPERC_PIS: TFloatField;
    qFilialPERC_COFINS: TFloatField;
    qFilialID_CSTICMS: TIntegerField;
    qFilialID_CSTIPI: TIntegerField;
    qFilialEMAIL_NFE: TStringField;
    qFilialDTESTOQUE: TDateField;
    qFilialPRINCIPAL: TStringField;
    qFilialLIBERADO_ATE: TStringField;
    qFilialULTIMO_ACESSO: TStringField;
    sdsNCM: TSQLDataSet;
    dspNCM: TDataSetProvider;
    cdsNCM: TClientDataSet;
    dsNCM: TDataSource;
    sdsNCMID: TIntegerField;
    sdsNCMNCM: TStringField;
    sdsNCMNOME: TStringField;
    cdsNCMID: TIntegerField;
    cdsNCMNCM: TStringField;
    cdsNCMNOME: TStringField;
    qParametrosATUALIZAR_PRECO: TStringField;
    sdsProdutoDT_ALTPRECO: TDateField;
    cdsProdutoDT_ALTPRECO: TDateField;
    sdsNotaFiscalID_OPERACAO_NOTA: TIntegerField;
    sdsNotaFiscalFINALIDADE: TStringField;
    sdsNotaFiscalID_VARIACAO: TIntegerField;
    sdsNotaFiscal_ItensID_OPERACAO_NOTA: TIntegerField;
    sdsNotaFiscal_ItensITEM_DEVOL: TStringField;
    sdsNotaFiscal_ItensID_PEDIDO: TIntegerField;
    sdsNotaFiscal_ItensFINALIDADE: TStringField;
    sdsNotaFiscal_ItensID_VARIACAO: TIntegerField;
    cdsNotaFiscal_ItensID_OPERACAO_NOTA: TIntegerField;
    cdsNotaFiscal_ItensITEM_DEVOL: TStringField;
    cdsNotaFiscal_ItensID_PEDIDO: TIntegerField;
    cdsNotaFiscal_ItensFINALIDADE: TStringField;
    cdsNotaFiscal_ItensID_VARIACAO: TIntegerField;
    sdsUnidade: TSQLDataSet;
    dspUnidade: TDataSetProvider;
    cdsUnidade: TClientDataSet;
    dsUnidade: TDataSource;
    sdsUnidadeUNIDADE: TStringField;
    sdsUnidadeCONVERSOR: TFloatField;
    sdsUnidadeNOME: TStringField;
    cdsUnidadeUNIDADE: TStringField;
    cdsUnidadeCONVERSOR: TFloatField;
    cdsUnidadeNOME: TStringField;
    sdsDuplicata: TSQLDataSet;
    sdsDuplicataID: TIntegerField;
    sdsDuplicataTIPO_ES: TStringField;
    sdsDuplicataFILIAL: TIntegerField;
    sdsDuplicataID_NOTA: TIntegerField;
    sdsDuplicataPARCELA: TIntegerField;
    sdsDuplicataNUMDUPLICATA: TStringField;
    sdsDuplicataNUMNOTA: TIntegerField;
    sdsDuplicataSERIE: TStringField;
    sdsDuplicataDTVENCIMENTO: TDateField;
    sdsDuplicataVLR_PARCELA: TFloatField;
    sdsDuplicataVLR_RESTANTE: TFloatField;
    sdsDuplicataVLR_PAGO: TFloatField;
    sdsDuplicataVLR_DEVOLUCAO: TFloatField;
    sdsDuplicataVLR_DESPESAS: TFloatField;
    sdsDuplicataVLR_DESCONTO: TFloatField;
    sdsDuplicataVLR_JUROSPAGOS: TFloatField;
    sdsDuplicataVLR_COMISSAO: TFloatField;
    sdsDuplicataPERC_COMISSAO: TFloatField;
    sdsDuplicataDTULTPAGAMENTO: TDateField;
    sdsDuplicataID_PESSOA: TIntegerField;
    sdsDuplicataID_CONTA: TIntegerField;
    sdsDuplicataID_TIPOCOBRANCA: TIntegerField;
    sdsDuplicataID_VENDEDOR: TIntegerField;
    sdsDuplicataID_CONTA_BOLETO: TIntegerField;
    sdsDuplicataID_COMISSAO: TIntegerField;
    sdsDuplicataQTD_DIASATRASO: TIntegerField;
    sdsDuplicataDTRECEBIMENTO_TITULO: TDateField;
    sdsDuplicataDTEMISSAO: TDateField;
    sdsDuplicataPAGO_CARTORIO: TStringField;
    sdsDuplicataPROTESTADO: TStringField;
    sdsDuplicataTIPO_LANCAMENTO: TStringField;
    sdsDuplicataTRANSFERENCIA_ICMS: TStringField;
    sdsDuplicataNOSSONUMERO: TStringField;
    sdsDuplicataDTFINANCEIRO: TDateField;
    sdsDuplicataNUMCHEQUE: TIntegerField;
    sdsDuplicataACEITE: TStringField;
    sdsDuplicataARQUIVO_GERADO: TStringField;
    dspDuplicata: TDataSetProvider;
    cdsDuplicata: TClientDataSet;
    cdsDuplicataID: TIntegerField;
    cdsDuplicataTIPO_ES: TStringField;
    cdsDuplicataFILIAL: TIntegerField;
    cdsDuplicataID_NOTA: TIntegerField;
    cdsDuplicataPARCELA: TIntegerField;
    cdsDuplicataNUMDUPLICATA: TStringField;
    cdsDuplicataNUMNOTA: TIntegerField;
    cdsDuplicataSERIE: TStringField;
    cdsDuplicataDTVENCIMENTO: TDateField;
    cdsDuplicataVLR_PARCELA: TFloatField;
    cdsDuplicataVLR_RESTANTE: TFloatField;
    cdsDuplicataVLR_PAGO: TFloatField;
    cdsDuplicataVLR_DEVOLUCAO: TFloatField;
    cdsDuplicataVLR_DESPESAS: TFloatField;
    cdsDuplicataVLR_DESCONTO: TFloatField;
    cdsDuplicataVLR_JUROSPAGOS: TFloatField;
    cdsDuplicataVLR_COMISSAO: TFloatField;
    cdsDuplicataPERC_COMISSAO: TFloatField;
    cdsDuplicataDTULTPAGAMENTO: TDateField;
    cdsDuplicataID_PESSOA: TIntegerField;
    cdsDuplicataID_CONTA: TIntegerField;
    cdsDuplicataID_TIPOCOBRANCA: TIntegerField;
    cdsDuplicataID_VENDEDOR: TIntegerField;
    cdsDuplicataID_CONTA_BOLETO: TIntegerField;
    cdsDuplicataID_COMISSAO: TIntegerField;
    cdsDuplicataQTD_DIASATRASO: TIntegerField;
    cdsDuplicataDTRECEBIMENTO_TITULO: TDateField;
    cdsDuplicataDTEMISSAO: TDateField;
    cdsDuplicataPAGO_CARTORIO: TStringField;
    cdsDuplicataPROTESTADO: TStringField;
    cdsDuplicataTIPO_LANCAMENTO: TStringField;
    cdsDuplicataTRANSFERENCIA_ICMS: TStringField;
    cdsDuplicataNOSSONUMERO: TStringField;
    cdsDuplicataDTFINANCEIRO: TDateField;
    cdsDuplicataNUMCHEQUE: TIntegerField;
    cdsDuplicataACEITE: TStringField;
    cdsDuplicataARQUIVO_GERADO: TStringField;
    cdsDuplicatasdsDuplicata_Hist: TDataSetField;
    dsDuplicata_Mestre: TDataSource;
    sdsDuplicata_Hist: TSQLDataSet;
    sdsDuplicata_HistID: TIntegerField;
    sdsDuplicata_HistITEM: TIntegerField;
    sdsDuplicata_HistID_HISTORICO: TIntegerField;
    sdsDuplicata_HistCOMPLEMENTO: TStringField;
    sdsDuplicata_HistVLR_PAGAMENTO: TFloatField;
    sdsDuplicata_HistVLR_JUROSPAGOS: TFloatField;
    sdsDuplicata_HistVLR_DESCONTOS: TFloatField;
    sdsDuplicata_HistVLR_DESPESAS: TFloatField;
    sdsDuplicata_HistVLR_DEVOLUCAO: TFloatField;
    sdsDuplicata_HistVLR_JUROSCALCULADO: TFloatField;
    sdsDuplicata_HistNUMCHEQUE: TIntegerField;
    sdsDuplicata_HistDTPREVISAO_CHEQUE: TDateField;
    sdsDuplicata_HistID_CONTA: TIntegerField;
    sdsDuplicata_HistID_COMISSAO: TIntegerField;
    sdsDuplicata_HistTIPO_ES: TStringField;
    sdsDuplicata_HistTIPO_HISTORICO: TStringField;
    sdsDuplicata_HistDTHISTORICO: TDateField;
    sdsDuplicata_HistDTLANCAMENTO: TDateField;
    cdsDuplicata_Hist: TClientDataSet;
    cdsDuplicata_HistID: TIntegerField;
    cdsDuplicata_HistITEM: TIntegerField;
    cdsDuplicata_HistID_HISTORICO: TIntegerField;
    cdsDuplicata_HistCOMPLEMENTO: TStringField;
    cdsDuplicata_HistVLR_PAGAMENTO: TFloatField;
    cdsDuplicata_HistVLR_JUROSPAGOS: TFloatField;
    cdsDuplicata_HistVLR_DESCONTOS: TFloatField;
    cdsDuplicata_HistVLR_DESPESAS: TFloatField;
    cdsDuplicata_HistVLR_DEVOLUCAO: TFloatField;
    cdsDuplicata_HistVLR_JUROSCALCULADO: TFloatField;
    cdsDuplicata_HistNUMCHEQUE: TIntegerField;
    cdsDuplicata_HistDTPREVISAO_CHEQUE: TDateField;
    cdsDuplicata_HistID_CONTA: TIntegerField;
    cdsDuplicata_HistID_COMISSAO: TIntegerField;
    cdsDuplicata_HistTIPO_ES: TStringField;
    cdsDuplicata_HistTIPO_HISTORICO: TStringField;
    cdsDuplicata_HistDTHISTORICO: TDateField;
    cdsDuplicata_HistDTLANCAMENTO: TDateField;
    cdsNotaFiscalID_OPERACAO_NOTA: TIntegerField;
    cdsNotaFiscalFINALIDADE: TStringField;
    cdsNotaFiscalID_VARIACAO: TIntegerField;
    sdsNotaFiscal_Parc: TSQLDataSet;
    sdsNotaFiscal_ParcID: TIntegerField;
    sdsNotaFiscal_ParcITEM: TIntegerField;
    sdsNotaFiscal_ParcDTVENCIMENTO: TDateField;
    sdsNotaFiscal_ParcVLR_VENCIMENTO: TFloatField;
    sdsNotaFiscal_ParcID_TIPOCOBRANCA: TIntegerField;
    sdsNotaFiscal_ParcID_CONTA: TIntegerField;
    cdsNotaFiscalsdsNotaFiscal_Parc: TDataSetField;
    cdsNotaFiscal_Parc: TClientDataSet;
    cdsNotaFiscal_ParcID: TIntegerField;
    cdsNotaFiscal_ParcITEM: TIntegerField;
    cdsNotaFiscal_ParcDTVENCIMENTO: TDateField;
    cdsNotaFiscal_ParcVLR_VENCIMENTO: TFloatField;
    cdsNotaFiscal_ParcID_TIPOCOBRANCA: TIntegerField;
    cdsNotaFiscal_ParcID_CONTA: TIntegerField;
    qFilial2: TSQLQuery;
    qFilial2ID: TIntegerField;
    qFilial2NOME: TStringField;
    qFilial2NOME_INTERNO: TStringField;
    qFilial2CNPJ_CPF: TStringField;
    qParametrosUSA_DESCRICAODANOTA: TStringField;
    mItensNotaNomeProduto_Nota: TStringField;
    sdsDuplicata_HistVLR_LANCAMENTO: TFloatField;
    cdsDuplicata_HistVLR_LANCAMENTO: TFloatField;
    qDePara: TSQLQuery;
    qDeParaID: TIntegerField;
    qDeParaID_CFOP_ENT: TIntegerField;
    qDeParaTIPO_PRODUTO: TStringField;
    qDeParaID_CFOP_GRA: TIntegerField;
    mItensNotaTipoVenda: TStringField;
    qDeParaCOD_CFOP_ENT: TStringField;
    qDeParaCOD_CFOP_GRA: TStringField;
    sdsTab_CSTIPI: TSQLDataSet;
    dspTab_CSTIPI: TDataSetProvider;
    cdsTab_CSTIPI: TClientDataSet;
    dsTab_CSTIPI: TDataSource;
    cdsTab_CSTIPIID: TIntegerField;
    cdsTab_CSTIPICOD_IPI: TStringField;
    cdsTab_CSTIPINOME: TStringField;
    cdsTab_CSTIPIGERAR_IPI: TStringField;
    qCofins: TSQLQuery;
    qPis: TSQLQuery;
    qCofinsID: TIntegerField;
    qCofinsCODIGO: TStringField;
    qCofinsNOME: TStringField;
    qCofinsGERAR: TStringField;
    qPisID: TIntegerField;
    qPisCODIGO: TStringField;
    qPisNOME: TStringField;
    qPisGERAR: TStringField;
    mItensNotaID_CSTIPI: TIntegerField;
    mItensNotaID_CSTICMS: TIntegerField;
    mItensNotaID_Cofins: TIntegerField;
    mItensNotaID_Pis: TIntegerField;
    sdsNotaFiscal_Ref: TSQLDataSet;
    sdsNotaFiscal_RefID: TIntegerField;
    sdsNotaFiscal_RefITEM: TIntegerField;
    sdsNotaFiscal_RefTIPO: TStringField;
    sdsNotaFiscal_RefID_NOTAREF: TIntegerField;
    sdsNotaFiscal_RefNUMNOTA_REF: TIntegerField;
    sdsNotaFiscal_RefSERIE_REF: TStringField;
    sdsNotaFiscal_RefUF_REF: TStringField;
    sdsNotaFiscal_RefANO_REF: TIntegerField;
    sdsNotaFiscal_RefMES_REF: TIntegerField;
    sdsNotaFiscal_RefCNPJ_REF: TStringField;
    sdsNotaFiscal_RefMODELO_REF: TStringField;
    sdsNotaFiscal_RefNFECHAVEACESSO_REF: TStringField;
    sdsNotaFiscal_RefID_FORNECEDOR: TIntegerField;
    sdsNotaFiscal_RefDESCRICAO_TIPO: TStringField;
    sdsNotaFiscal_RefCUPOM_NUMECF: TIntegerField;
    sdsNotaFiscal_RefCUPOM_NUMCOO: TIntegerField;
    sdsNotaFiscal_RefCUPOM_MODELO: TStringField;
    sdsNotaFiscal_RefINSCESTADUAL_REF: TStringField;
    cdsNotaFiscal_Ref: TClientDataSet;
    cdsNotaFiscal_RefID: TIntegerField;
    cdsNotaFiscal_RefITEM: TIntegerField;
    cdsNotaFiscal_RefTIPO: TStringField;
    cdsNotaFiscal_RefID_NOTAREF: TIntegerField;
    cdsNotaFiscal_RefNUMNOTA_REF: TIntegerField;
    cdsNotaFiscal_RefSERIE_REF: TStringField;
    cdsNotaFiscal_RefUF_REF: TStringField;
    cdsNotaFiscal_RefANO_REF: TIntegerField;
    cdsNotaFiscal_RefMES_REF: TIntegerField;
    cdsNotaFiscal_RefCNPJ_REF: TStringField;
    cdsNotaFiscal_RefINSCESTADUAL_REF: TStringField;
    cdsNotaFiscal_RefMODELO_REF: TStringField;
    cdsNotaFiscal_RefNFECHAVEACESSO_REF: TStringField;
    cdsNotaFiscal_RefID_FORNECEDOR: TIntegerField;
    cdsNotaFiscal_RefDESCRICAO_TIPO: TStringField;
    cdsNotaFiscal_RefCUPOM_NUMECF: TIntegerField;
    cdsNotaFiscal_RefCUPOM_NUMCOO: TIntegerField;
    cdsNotaFiscal_RefCUPOM_MODELO: TStringField;
    dsNotaFiscal_Ref: TDataSource;
    cdsNotaFiscalsdsNotaFiscal_Ref: TDataSetField;
    sdsNotaFiscal_ItensPERC_TRIBICMS: TFloatField;
    sdsNotaFiscal_ItensCOD_PRODUTO_FORN: TStringField;
    sdsNotaFiscal_ItensCOD_BARRA: TStringField;
    sdsNotaFiscal_ItensIMP_OC_NOTA: TStringField;
    sdsNotaFiscal_ItensNUM_PEDIDO: TIntegerField;
    sdsNotaFiscal_ItensID_NTE: TIntegerField;
    sdsNotaFiscal_ItensITEM_NTE: TIntegerField;
    sdsNotaFiscal_ItensQTD_NOTAATUAL: TFloatField;
    sdsNotaFiscal_ItensVLR_DUPLICATA: TFloatField;
    cdsNotaFiscal_ItensPERC_TRIBICMS: TFloatField;
    cdsNotaFiscal_ItensCOD_PRODUTO_FORN: TStringField;
    cdsNotaFiscal_ItensCOD_BARRA: TStringField;
    cdsNotaFiscal_ItensIMP_OC_NOTA: TStringField;
    cdsNotaFiscal_ItensNUM_PEDIDO: TIntegerField;
    cdsNotaFiscal_ItensID_NTE: TIntegerField;
    cdsNotaFiscal_ItensITEM_NTE: TIntegerField;
    cdsNotaFiscal_ItensQTD_NOTAATUAL: TFloatField;
    cdsNotaFiscal_ItensVLR_DUPLICATA: TFloatField;
    sdsNotaFiscal_ItensTIPO_NOTA: TStringField;
    cdsNotaFiscal_ItensTIPO_NOTA: TStringField;
    sdsProdutoID_FORNECEDOR: TIntegerField;
    cdsProdutoID_FORNECEDOR: TIntegerField;
    sdsProdutoCOD_BARRA: TStringField;
    cdsProdutoCOD_BARRA: TStringField;
    qParametrosENDXML_NOTAENTRADA: TStringField;
    sdsDuplicataID_COB_ELETRONICA: TIntegerField;
    sdsDuplicataBOLETO_IMP: TStringField;
    sdsDuplicataID_CARTEIRA: TIntegerField;
    sdsDuplicataID_BANCO: TIntegerField;
    cdsDuplicataID_COB_ELETRONICA: TIntegerField;
    cdsDuplicataBOLETO_IMP: TStringField;
    cdsDuplicataID_CARTEIRA: TIntegerField;
    cdsDuplicataID_BANCO: TIntegerField;
    mItensNotaReferencia_Int: TStringField;
    qParametrosGRAVAR_NA_REF_CODPRODFORN: TStringField;
    qParametrosGRAVAR_PROD_MAT_RECXML: TStringField;
    sdsOC: TSQLDataSet;
    dspOC: TDataSetProvider;
    cdsOC: TClientDataSet;
    dsOC: TDataSource;
    cdsOCID: TIntegerField;
    cdsOCID_CLIENTE: TIntegerField;
    cdsOCDTEMISSAO: TDateField;
    cdsOCID_PRODUTO: TIntegerField;
    cdsOCID_CFOP: TIntegerField;
    cdsOCNUM_PEDIDO: TIntegerField;
    cdsOCVLR_UNITARIO: TFloatField;
    cdsOCQTD: TFloatField;
    cdsOCQTD_FATURADO: TFloatField;
    cdsOCQTD_RESTANTE: TFloatField;
    cdsOCQTD_AFATURAR: TFloatField;
    cdsOCNOMEFORNECEDOR: TStringField;
    cdsOCREFERENCIA: TStringField;
    cdsOCNOMEPRODUTO: TStringField;
    cdsOCCNPJ_CPF: TStringField;
    cdsOCDTENTREGA: TDateField;
    cdsOCITEM: TIntegerField;
    cdsOCVLR_DESCONTO: TFloatField;
    cdsOCID_NCM: TIntegerField;
    cdsOCUNIDADE: TStringField;
    cdsOCPERC_IPI: TFloatField;
    cdsOCOBS_COMPLEMENTAR: TStringField;
    cdsOCNUMOS: TStringField;
    cdsOCTIPO_FRETE: TStringField;
    cdsOCID_CONDPGTO: TIntegerField;
    cdsOCIMP_OC_NOTA: TStringField;
    cdsOCID_VARIACAO: TIntegerField;
    mItensNotaID_Pedido: TIntegerField;
    sdsNotaFiscal_ItensTIPO_REG: TStringField;
    cdsNotaFiscal_ItensTIPO_REG: TStringField;
    sdsPrc_Atualiza_Status_Ped: TSQLDataSet;
    mPedidoAux: TClientDataSet;
    mPedidoAuxID_Pedido: TIntegerField;
    qParametrosGRAVAR_INF_ADICIONAIS_NTE: TStringField;
    sdsNCMPERC_RED_STRIB: TFloatField;
    sdsNCMGERAR_ST: TStringField;
    cdsNCMPERC_RED_STRIB: TFloatField;
    cdsNCMGERAR_ST: TStringField;
    sdsProduto_FornPRECO_CUSTO: TFloatField;
    cdsProduto_FornPRECO_CUSTO: TFloatField;
    mNota: TClientDataSet;
    mNotaVersao: TStringField;
    mNotaInfNFe_Id: TStringField;
    mNotaSerie: TStringField;
    mNotaNumNota: TIntegerField;
    mNotaID_Emitente: TIntegerField;
    mNotaCNPJ_CPF_Emitente: TStringField;
    mNotaPessoa: TStringField;
    mNotaNome_Emitente: TStringField;
    mNotaCFOP: TStringField;
    mNotaID_CFOP: TIntegerField;
    mNotaCFOP_Interno: TStringField;
    mNotaVlrTotal: TFloatField;
    mNotaVlrProduto: TFloatField;
    mNotaVlrICMS: TFloatField;
    mNotaBaseICMS: TFloatField;
    mNotaVlrIPI: TFloatField;
    mNotaVlrCofins: TFloatField;
    mNotaVlrPis: TFloatField;
    mNotaVlrICMSSimples: TFloatField;
    mNotaBaseICMSSimples: TFloatField;
    mNotaDtEmissao: TDateField;
    mNotaChaveAcesso: TStringField;
    mNotaProtocolo: TStringField;
    mNotaTipoAmbiente: TStringField;
    mNotaVerProc: TStringField;
    mNotaDtSaida: TDateField;
    mNotaProcesso: TStringField;
    mNotaedtFormaEmissao: TStringField;
    mNotaModelo: TStringField;
    mNotaTipoPagamento: TStringField;
    mNotaTipoPagamento_Des: TStringField;
    mNotaFinalidade: TStringField;
    mNotaCNPJ_CPF_Destinatario: TStringField;
    dsmNota: TDataSource;
    mNotaArquivo_XML: TStringField;
    mNotaVlrOutrasDespesas: TFloatField;
    mNotaVlrSeguro: TFloatField;
    mNotaVlrFrete: TFloatField;
    mNotaVlrDesconto: TFloatField;
    mNotaHrSaida: TStringField;
    mNotaFilial: TIntegerField;
    mNotaCodMunicipio: TStringField;
    mNotaID_Cidade: TIntegerField;
    mNotaNome_Cidade: TStringField;
    mNotaUF: TStringField;
    mNotaID_Pais: TIntegerField;
    mNotaCodPais: TStringField;
    mNotaTipo_ES: TStringField;
    mNotaIE_Emitente: TStringField;
    mNotaIE_Destinatario: TStringField;
    mNotaID_Transportadora: TIntegerField;
    mNotaCNPJ_CPF_Transportadora: TStringField;
    mNotaCRT: TIntegerField;
    mItensNotaItem_Unidade: TIntegerField;
    sdsProduto_FornITEM_UNIDADE: TIntegerField;
    cdsProduto_FornITEM_UNIDADE: TIntegerField;
    qProduto_Uni: TSQLQuery;
    qProduto_UniUNIDADE_CONV: TStringField;
    qProduto_UniQTD: TFloatField;
    sdsProduto_FornUNIDADE_FORN: TStringField;
    cdsProduto_FornUNIDADE_FORN: TStringField;
    mItensNotaConverter_Unid_Medida: TBooleanField;
    mItensNotaQtdPacoteInterno: TFloatField;
    sdsUnidade_Conv: TSQLDataSet;
    dspUnidade_Conv: TDataSetProvider;
    cdsUnidade_Conv: TClientDataSet;
    cdsUnidade_ConvUNIDADE: TStringField;
    cdsUnidade_ConvITEM: TIntegerField;
    cdsUnidade_ConvUNIDADE_CONV: TStringField;
    cdsUnidade_ConvNOME: TStringField;
    cdsUnidade_ConvQTD: TFloatField;
    sdsProduto_Uni: TSQLDataSet;
    dspProduto_Uni: TDataSetProvider;
    cdsProduto_Uni: TClientDataSet;
    sdsProduto_UniID: TIntegerField;
    sdsProduto_UniITEM: TIntegerField;
    sdsProduto_UniUNIDADE_CONV: TStringField;
    sdsProduto_UniUNIDADE: TStringField;
    sdsProduto_UniITEM_UNIDADE: TIntegerField;
    cdsProduto_UniID: TIntegerField;
    cdsProduto_UniITEM: TIntegerField;
    cdsProduto_UniUNIDADE_CONV: TStringField;
    cdsProduto_UniUNIDADE: TStringField;
    cdsProduto_UniITEM_UNIDADE: TIntegerField;
    qUnidade_Conv: TSQLQuery;
    qUnidade_ConvUNIDADE: TStringField;
    qUnidade_ConvITEM: TIntegerField;
    qUnidade_ConvUNIDADE_CONV: TStringField;
    qUnidade_ConvNOME: TStringField;
    qUnidade_ConvQTD: TFloatField;
    sdsNotaFiscal_ItensID_MOVIMENTO: TIntegerField;
    cdsNotaFiscal_ItensID_MOVIMENTO: TIntegerField;
    mItensNotaUnidadeInterno: TStringField;
    sdsUnidade2: TSQLDataSet;
    dspUnidade2: TDataSetProvider;
    cdsUnidade2: TClientDataSet;
    dsUnidade2: TDataSource;
    cdsUnidade2UNIDADE: TStringField;
    cdsUnidade2CONVERSOR: TFloatField;
    cdsUnidade2NOME: TStringField;
    qDeParaID_SITTRIB_CF: TIntegerField;
    qDeParaCOD_SITTRIB_CF: TStringField;
    mItensNotaID_SitTrib_CF: TIntegerField;
    mItensNotaCod_SitTrib_CF: TStringField;
    sdsSitTrib_CF: TSQLDataSet;
    dspSitTrib_CF: TDataSetProvider;
    cdsSitTrib_CF: TClientDataSet;
    dsSitTrib_CF: TDataSource;
    cdsSitTrib_CFID: TIntegerField;
    cdsSitTrib_CFCODIGO: TStringField;
    cdsSitTrib_CFPERCENTUAL: TFloatField;
    sdsProdutoID_SITTRIB_CF: TIntegerField;
    cdsProdutoID_SITTRIB_CF: TIntegerField;
    qParametrosUSA_CUPOM_FISCAL: TStringField;
    qParametrosUSA_PERC_MARGEM_RECEPCAO: TStringField;
    cdsCabecalhoide_dhemi: TStringField;
    cdsCabecalhoide_dEmi: TDateField;
    sdsDuplicataTIPO_MOV: TStringField;
    cdsDuplicataTIPO_MOV: TStringField;
    cdsCFOPGERAR_ESTOQUE: TStringField;
    qParametrosPROCURAR_POR_REF_XML: TStringField;
    qProduto_Uni2: TSQLQuery;
    qProduto_Uni2UNIDADE_CONV: TStringField;
    qProduto_Uni2QTD: TFloatField;
    qProduto_Uni2ITEM_UNIDADE: TIntegerField;
    dsCliente: TDataSource;
    cdsCliente: TClientDataSet;
    dspCliente: TDataSetProvider;
    sdsCliente: TSQLDataSet;
    cdsClienteCODIGO: TIntegerField;
    cdsClienteNOME: TStringField;
    cdsClienteCNPJ_CPF: TStringField;
    dsFilial: TDataSource;
    cdsFilial: TClientDataSet;
    dspFilial: TDataSetProvider;
    sdsFilial: TSQLDataSet;
    cdsFilialID: TIntegerField;
    cdsFilialNOME: TStringField;
    cdsFilialNOME_INTERNO: TStringField;
    cdsFilialCNPJ_CPF: TStringField;
    mItensNotaUsa_Cor: TStringField;
    sdsProdutoUSA_PRECO_COR: TStringField;
    cdsProdutoUSA_PRECO_COR: TStringField;
    mItensNotaID_Cor: TIntegerField;
    sdsCombinacao: TSQLDataSet;
    dspCombinacao: TDataSetProvider;
    cdsCombinacao: TClientDataSet;
    cdsCombinacaoID_PRODUTO: TIntegerField;
    cdsCombinacaoNOME: TStringField;
    cdsCombinacaoID_COMBINACAO_COR: TFMTBCDField;
    cdsCombinacaoPRECO_CUSTO: TFloatField;
    dsCombinacao: TDataSource;
    qParametrosINFORMAR_COR_MATERIAL: TStringField;
    qParametrosINFORMAR_COR_PROD: TStringField;
    mItensNotaUsa_Preco_Cor: TStringField;
    sdsProdutoUSA_COR: TStringField;
    cdsProdutoUSA_COR: TStringField;
    cdsOCUSA_COR: TStringField;
    cdsOCUSA_PRECO_COR: TStringField;
    sdsDuplicataANO_REF: TIntegerField;
    sdsDuplicataMES_REF: TIntegerField;
    sdsDuplicataTITULO_CARTORIO: TStringField;
    cdsDuplicataANO_REF: TIntegerField;
    cdsDuplicataMES_REF: TIntegerField;
    cdsDuplicataTITULO_CARTORIO: TStringField;
    sdsDuplicataID_CONTA_ORCAMENTO: TIntegerField;
    cdsDuplicataID_CONTA_ORCAMENTO: TIntegerField;
    sdsFornecedorFORNECEDOR_CONTA_ID: TIntegerField;
    cdsFornecedorFORNECEDOR_CONTA_ID: TIntegerField;
    mItensNotaInativo_Produto: TStringField;
    sdsProduto_FornINATIVO: TStringField;
    cdsProduto_FornINATIVO: TStringField;
    qProdutoInativo: TSQLQuery;
    qProdutoInativoINATIVO: TStringField;
    qProdutoInativoID: TIntegerField;
    sdsProdutoID_CONTA_ORCAMENTO: TIntegerField;
    cdsProdutoID_CONTA_ORCAMENTO: TIntegerField;
    sdsNotaFiscal_ItensCONTA_ORCAMENTO_ID: TIntegerField;
    cdsNotaFiscal_ItensCONTA_ORCAMENTO_ID: TIntegerField;
    qParametrosUSA_LOCAL_ESTOQUE: TStringField;
    sdsLocal_Estoque: TSQLDataSet;
    dspLocal_Estoque: TDataSetProvider;
    cdsLocal_Estoque: TClientDataSet;
    cdsLocal_EstoqueID: TIntegerField;
    cdsLocal_EstoqueCOD_LOCAL: TIntegerField;
    cdsLocal_EstoqueNOME: TStringField;
    cdsLocal_EstoqueENDERECO: TStringField;
    cdsLocal_EstoqueNUM_ENDERECO: TStringField;
    cdsLocal_EstoqueID_CIDADE: TIntegerField;
    cdsLocal_EstoqueUF: TStringField;
    cdsLocal_EstoqueBAIRRO: TStringField;
    cdsLocal_EstoqueCEP: TStringField;
    cdsLocal_EstoquePRINCIPAL: TStringField;
    cdsLocal_EstoqueINATIVO: TStringField;
    dsLocal_Estoque: TDataSource;
    sdsNotaFiscalID_LOCAL_ESTOQUE: TIntegerField;
    cdsNotaFiscalID_LOCAL_ESTOQUE: TIntegerField;
    sdsProduto_FornCOD_MATERIAL_FORN: TStringField;
    cdsProduto_FornCOD_MATERIAL_FORN: TStringField;
    sdsFornecedorORGAO_PUBLICO: TStringField;
    sdsFornecedorCLIENTE_ESTOQUE: TStringField;
    sdsFornecedorUSA_TAMANHO_AGRUPADO_NFE: TStringField;
    sdsFornecedorTP_ALUNO: TStringField;
    sdsFornecedorTIPO_CONSUMIDOR: TSmallintField;
    sdsFornecedorTIPO_CONTRIBUINTE: TSmallintField;
    sdsFornecedorTP_PREPOSTO: TStringField;
    sdsFornecedorTP_EXPORTACAO: TStringField;
    cdsFornecedorORGAO_PUBLICO: TStringField;
    cdsFornecedorCLIENTE_ESTOQUE: TStringField;
    cdsFornecedorUSA_TAMANHO_AGRUPADO_NFE: TStringField;
    cdsFornecedorTP_ALUNO: TStringField;
    cdsFornecedorTIPO_CONSUMIDOR: TSmallintField;
    cdsFornecedorTIPO_CONTRIBUINTE: TSmallintField;
    cdsFornecedorTP_PREPOSTO: TStringField;
    cdsFornecedorTP_EXPORTACAO: TStringField;
    qParametrosUSA_LOTE_CONTROLE: TStringField;
    sdsNotaFiscal_ItensNUM_LOTE_CONTROLE: TStringField;
    cdsNotaFiscal_ItensNUM_LOTE_CONTROLE: TStringField;
    mItensNotaNum_Lote_Controle: TStringField;
    qParametrosID_LOCAL_ESTOQUE_NTE: TIntegerField;
    qNCM: TSQLQuery;
    qNCMNCM: TStringField;
    sdsDuplicataPERC_BASE_COMISSAO: TFloatField;
    cdsDuplicataPERC_BASE_COMISSAO: TFloatField;
    sdsEstoque_MovGERAR_CUSTO: TStringField;
    cdsEstoque_MovGERAR_CUSTO: TStringField;
    qParametrosUSA_APROVACAO_OC_FORN: TStringField;
    qFilial2LOCALSERVIDORNFE: TStringField;
    qParametros_Geral: TSQLQuery;
    qParametros_GeralUSAR_PESSOA_FILIAL: TStringField;
    qParametros_Prod: TSQLQuery;
    qParametros_ProdUSA_PRODUTO_FILIAL: TStringField;
    sdsFornecedorFILIAL: TIntegerField;
    cdsFornecedorFILIAL: TIntegerField;
    sdsProdutoFILIAL: TIntegerField;
    cdsProdutoFILIAL: TIntegerField;
    qDeParaID_CFOP_PROD_NFCE: TIntegerField;
    qDeParaCOD_CFOP_PROD_NFCE: TStringField;
    qParametrosUSA_NFCE: TStringField;
    sdsProdutoID_CFOP_NFCE: TIntegerField;
    cdsProdutoID_CFOP_NFCE: TIntegerField;
    mItensNotaID_CFOP_NFCe: TIntegerField;
    mItensNotaCodCFOP_NFCe: TStringField;
    sdsDuplicataID_TERMINAL: TIntegerField;
    cdsDuplicataID_TERMINAL: TIntegerField;
    qParametros_RecXML: TSQLQuery;
    qParametros_RecXMLID: TIntegerField;
    qParametros_RecXMLPROCURAR_REM_NOME_PROD: TStringField;
    mItensNotaObs_Complementar: TStringField;
    sdsDuplicataVLR_MULTA: TFloatField;
    cdsDuplicataVLR_MULTA: TFloatField;
    sdsDuplicata_HistVLR_MULTA: TFloatField;
    cdsDuplicata_HistVLR_MULTA: TFloatField;
    qParametros_OC: TSQLQuery;
    qParametros_OCID: TIntegerField;
    qParametros_OCPERMITIR_ENT_MAIOR: TStringField;
    qParametros_NTE: TSQLQuery;
    qParametros_NTEID: TIntegerField;
    qParametros_NTESOMAR_IPI_NO_CUSTO: TStringField;
    qParametros_NTESOMAR_FRETE_NO_CUSTO: TStringField;
    qParametros_NTEATUALIZAR_CUSTO: TStringField;
    qParametros_ProdOPCAO_APLICAR_MARGEM: TStringField;
    sdsProdutoPRECO_CUSTO_TOTAL: TFloatField;
    cdsProdutoPRECO_CUSTO_TOTAL: TFloatField;
    sdsProdutoDT_ALT_PRECOCUSTO: TDateField;
    cdsProdutoDT_ALT_PRECOCUSTO: TDateField;
    sdsProduto_FornPRECO_CUSTO_TOTAL: TFloatField;
    cdsProduto_FornPRECO_CUSTO_TOTAL: TFloatField;
    mItensNotaAtualizarCustoTotal: TBooleanField;
    mItensNotaAtualizarPreco: TBooleanField;
    qParametros_ProdPERC_MARGEM_PRECO: TFloatField;
    mItensNotaPerc_Margem: TFloatField;
    mItensNotaID_Grupo: TIntegerField;
    mItensNotaNome_Grupo: TStringField;
    qGrupo: TSQLQuery;
    qGrupoID: TIntegerField;
    qGrupoNOME: TStringField;
    qGrupoCODIGO: TStringField;
    sdsProdutoID_GRUPO: TIntegerField;
    cdsProdutoID_GRUPO: TIntegerField;
    qParametros_GeralENDGRIDS: TStringField;
    qParametros_RecXMLATUALIZAR_NCM: TStringField;
    mItensNotaVlr_Venda: TFloatField;
    qParametros_RecXMLMOSTRAR_VLR_VENDA: TStringField;
    mItensNotaVlr_Custo_Prod: TFloatField;
    sdsProdutoUSA_PERC_IMP_INTERESTADUAL: TStringField;
    cdsProdutoUSA_PERC_IMP_INTERESTADUAL: TStringField;
    cdsCFOPTIPO_IND_VEN: TStringField;
    qParametros_NTESOMAR_ST_NO_CUSTO: TStringField;
    sdsProdutoREFERENCIA_SEQ: TIntegerField;
    cdsProdutoREFERENCIA_SEQ: TIntegerField;
    mItensNotaPerc_ISSQN: TFloatField;
    mItensNotaVlr_ISSQN: TFloatField;
    sdsNotaFiscal_ItensPERC_ISSQN: TFloatField;
    sdsNotaFiscal_ItensVLR_ISSQN: TFloatField;
    cdsNotaFiscal_ItensPERC_ISSQN: TFloatField;
    cdsNotaFiscal_ItensVLR_ISSQN: TFloatField;
    mItensNotaNumNota: TIntegerField;
    mItensNotaSerie: TStringField;
    mItensNotaNome_Cor: TStringField;
    qCor: TSQLQuery;
    qCorID: TFMTBCDField;
    qCorNOME: TStringField;
    cdsCabecalhoavulsa_dhEmi: TStringField;
    cdsDetalheCEST: TStringField;
    mItensNotaCEST: TStringField;
    qParametros_RecXMLATUALIZAR_CEST: TStringField;
    mItensNotaCEST_Interno: TStringField;
    sdsNCMCOD_CEST: TStringField;
    cdsNCMCOD_CEST: TStringField;
    qParametros_RecXMLUSA_DIRETORIO_COPIADO: TStringField;
    sdsNotaFiscal_ItensVLR_ICMS_FCP: TFloatField;
    sdsNotaFiscal_ItensVLR_ICMS_UF_DEST: TFloatField;
    sdsNotaFiscal_ItensVLR_ICMS_UF_REMET: TFloatField;
    cdsNotaFiscal_ItensVLR_ICMS_FCP: TFloatField;
    cdsNotaFiscal_ItensVLR_ICMS_UF_DEST: TFloatField;
    cdsNotaFiscal_ItensVLR_ICMS_UF_REMET: TFloatField;
    sdsProdutoUSA_CLIQ: TStringField;
    cdsProdutoUSA_CLIQ: TStringField;
    mItensNotaGerar_CLiquido: TBooleanField;
    sdsProdutoPRECO_LIQ: TFloatField;
    cdsProdutoPRECO_LIQ: TFloatField;
    sdsProduto_FornUSA_CLIQ: TStringField;
    cdsProduto_FornUSA_CLIQ: TStringField;
    sdsFornecedorCONT_CUSTO_LIQ: TStringField;
    cdsFornecedorCONT_CUSTO_LIQ: TStringField;
    qParametros_ProdUSA_LOTE_PROD: TStringField;
    mItensNotaSUB_PISCOFINS_CUSTO: TStringField;
    mItensNotaSUB_ICMS_CUSTO: TStringField;
    qParametros_NTESUB_PISCOFINS_CUSTO: TStringField;
    qParametros_NTESUB_ICMS_CUSTO: TStringField;
    mItensNotaSOMAR_IPI_NO_CUSTO: TStringField;
    mItensNotaSOMAR_FRETE_NO_CUSTO: TStringField;
    mItensNotaSOMAR_ST_NO_CUSTO: TStringField;
    mItensNotaTipoVenda_Prod: TStringField;
    cdsCFOPALT_NCM_CUSTO: TStringField;
    qCFOPALT_NCM_CUSTO: TStringField;
    mItensNotaAtualizarNCM: TBooleanField;
    qParametros_GeralUSA_TRIANGULAR: TStringField;
    qParametros_Custo: TSQLQuery;
    qParametros_CustoID: TIntegerField;
    qParametros_CustoREV_SOMAR_IPI: TStringField;
    qParametros_CustoREV_SOMAR_FRETE: TStringField;
    qParametros_CustoREV_SOMAR_ST: TStringField;
    qParametros_CustoREV_SUB_ICMS: TStringField;
    qParametros_CustoREV_SUB_PISCOFINS: TStringField;
    qParametros_CustoIND_SOMAR_IPI: TStringField;
    qParametros_CustoIND_SOMAR_FRETE: TStringField;
    qParametros_CustoIND_SOMAR_ST: TStringField;
    qParametros_CustoIND_SUB_ICMS: TStringField;
    qParametros_CustoIND_SUB_PISCOFINS: TStringField;
    qParametros_CustoCON_SOMAR_IPI: TStringField;
    qParametros_CustoCON_SOMAR_ST: TStringField;
    qParametros_CustoCON_SOMAR_FRETE: TStringField;
    qParametros_CustoCON_SUB_ICMS: TStringField;
    qParametros_CustoCON_SUB_PISCOFINS: TStringField;
    qParametros_RecXMLUSA_OC_XML: TStringField;
    cdsOCID_COR: TFMTBCDField;
    cdsOCUSA_OC_XML: TStringField;
    sdsProduto_FornCOD_COR_FORN: TStringField;
    sdsProduto_FornNOME_COR_FORN: TStringField;
    cdsProduto_FornCOD_COR_FORN: TStringField;
    cdsProduto_FornNOME_COR_FORN: TStringField;
    sdsProduto_FornTAMANHO_CLIENTE: TStringField;
    cdsProduto_FornTAMANHO_CLIENTE: TStringField;
    mItensNotaGravar_Adic_Prod: TStringField;
    qParametros_CustoCON_SUB_IPI: TStringField;
    qParametros_CustoIND_SUB_IPI: TStringField;
    qParametros_CustoREV_SUB_IPI: TStringField;
    mItensNotaSUB_IPI_Custo: TStringField;
    mItensNotaPreco_Custo_Total: TFloatField;
    sdsNotaFiscal_ItensPRECO_CUSTO_TOTAL: TFloatField;
    cdsNotaFiscal_ItensPRECO_CUSTO_TOTAL: TFloatField;
    qParametros_RecXMLPROCURAR_POR_CBARRA: TStringField;
    sdsDuplicataDTAPROVADO: TDateField;
    sdsDuplicataNGR: TStringField;
    sdsDuplicataAPROVADO: TStringField;
    cdsDuplicataDTAPROVADO: TDateField;
    cdsDuplicataNGR: TStringField;
    cdsDuplicataAPROVADO: TStringField;
    mItensNotaCodBarra2: TStringField;
    sdsNotaFiscal_ItensCOD_BARRA2: TStringField;
    cdsNotaFiscal_ItensCOD_BARRA2: TStringField;
    sdsProdutoCOD_BARRA2: TStringField;
    cdsProdutoCOD_BARRA2: TStringField;
    mItensNotaGerar_Estoque: TStringField;
    qParametros_RecXMLCONTROLAR_GRAVA_PROD: TStringField;
    sdsFornecedorASSOCIAR_PROD: TStringField;
    cdsFornecedorASSOCIAR_PROD: TStringField;
    qParametros_RecXMLUSA_REF_SEQUENCIAL: TStringField;
    qRefSeq: TSQLQuery;
    qRefSeqREFERENCIA_SEQ: TIntegerField;
    procedure DataModuleCreate(Sender: TObject);
    procedure dspNotaFiscalUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure dspProduto_FornUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure dspFornecedorUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure dspPaisUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure dspCidadeUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure dspProdutoUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure dspNCMUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure dspDuplicataUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure dspEstoque_MovUpdateError(Sender: TObject;
      DataSet: TCustomClientDataSet; E: EUpdateError;
      UpdateKind: TUpdateKind; var Response: TResolverResponse);
    procedure cdsNotaFiscal_ItensNewRecord(DataSet: TDataSet);
    procedure cdsNotaFiscal_ItensBeforePost(DataSet: TDataSet);
    procedure cdsNCMNewRecord(DataSet: TDataSet);
    procedure mNotaNewRecord(DataSet: TDataSet);
    procedure mItensNotaNewRecord(DataSet: TDataSet);
    procedure cdsFornecedorNewRecord(DataSet: TDataSet);
    procedure mItensNotaBeforePost(DataSet: TDataSet);
    procedure cdsProduto_FornBeforePost(DataSet: TDataSet);
    procedure cdsDuplicataNewRecord(DataSet: TDataSet);
  private
    { Private declarations }
    procedure DoLogAdditionalValues(ATableName: string; var AValues: TArrayLogData; var UserName: string);
  public
    { Public declarations }
    vMsgErro: String;
    ctCommand_CFOP: String;
    ctCommand_Produto: String;
    ctOC: String;
    ctProduto_Forn: String;
    vID_Pedido, vItem_Pedido: Integer;
    vNum_Pedido: String;
    vUnidade: String;
    vProduto_Inativo: String;
    vGerar_CLiq : String;

    procedure prc_Abrir_Produto(ID: Integer);
    procedure prc_Abrir_Estoque_Mov(ID: Integer);
    function fnc_Abrir_Nota(Filial,NumNota,ID_Cliente: Integer; Serie: String): Boolean;
    function fnc_Abrir_Produto_Forn(ID_Fornecedor: Integer; CodProdutoForn, CodBarra: String; Gravar: Boolean = False): Boolean;

    function fnc_Abrir_Fornecedor(CNPJ: String): Boolean;
    function fnc_Abrir_Cidade(CodMunicipio: String): Boolean;
    function fnc_Abrir_Pais(CodPais: String): Boolean;
    function fnc_Abrir_NCM(NCM: String): Integer;

    procedure AbrirNFe(AXMLNFe: string);
    procedure prc_Inserir_Parcela;
    procedure Abrir_cdsDuplicata(ID: Integer);
    procedure Gravar_Duplicata(Tipo, TransfICMS: String; Parcela: Integer; Valor: Real; Data: TDateTime); //P= Contas a Pagar   R= Contas a Receber
    procedure Gravar_Dupicata_Hist;

    procedure prc_Abrir_Combinacao(ID_Produto: Integer);
    procedure prc_Move_Dados_Da_OC;

    function fnc_Verifica_Produto_Forn(ID_Produto, ID_Fornecedor: Integer; Cod_Produto_Forn: String): Boolean;
    function fnc_Proximo_Item_Forn(ID_Produto: Integer): Integer; 
  end;

var
  DMRecebeXML: TDMRecebeXML;

implementation

uses DmdDatabase, Forms, uUtilPadrao, LogProvider, Math;

{$R *.dfm}

{ TDMCadCFOP}

procedure TDMRecebeXML.DataModuleCreate(Sender: TObject);
var
  i, x: Integer;
  SR: TSearchRec;
  Origem, Destino: string;
  vIndices: string;
  aIndices: array of string;
begin
  XMLTransformProvider1.TransformRead.TransformationFile := ExtractFilePath(Application.ExeName) + 'nfe_v2.00_ToDp.xtr';
  ctCommand_CFOP    := sdsCFOP.CommandText;
  ctCommand_Produto := sdsProduto.CommandText;
  ctOC              := sdsOC.CommandText;
  ctProduto_Forn    := sdsProduto_Forn.CommandText;
  qParametros.Close;
  qParametros.ParamByName('ID').AsInteger := 1;
  qParametros.Open;
  cdsTab_CSTICMS.Close;
  cdsTab_CSTICMS.Open;
  cdsTab_CSTIPI.Close;
  cdsTab_CSTIPI.Open;
  cdsCFOP.Open;
  qFilial2.Open;
  qDePara.Close;
  qDePara.Open;
  cdsSitTrib_CF.Open;
  cdsCliente.Open;
  cdsFilial.Open;
  cdsLocal_Estoque.Open;
  qParametros_Geral.Close;
  qParametros_Geral.Open;
  qParametros_Prod.Close;
  qParametros_Prod.Open;
  qParametros_RecXML.Close;
  qParametros_RecXML.Open;
  qParametros_OC.Open;
  qParametros_NTE.Open;
  qParametros_Custo.Open;
  //*** Logs Implantado na verso .353
  LogProviderList.OnAdditionalValues := DoLogAdditionalValues;
  for i := 0 to (Self.ComponentCount - 1) do
  begin
    if (Self.Components[i] is TClientDataSet) then
    begin
      SetLength(aIndices, 0);
      vIndices := TClientDataSet(Components[i]).IndexFieldNames;
      while (vIndices <> EmptyStr) do
      begin
        SetLength(aIndices, Length(aIndices) + 1);
        x := Pos(';', vIndices);
        if (x = 0) then
        begin
          aIndices[Length(aIndices) - 1] := vIndices;
          vIndices := EmptyStr;
        end
        else
        begin
          aIndices[Length(aIndices) - 1] := Copy(vIndices, 1, x - 1);
          vIndices := Copy(vIndices, x + 1, MaxInt);
        end;
      end;
      LogProviderList.AddProvider(TClientDataSet(Self.Components[i]), TClientDataSet(Self.Components[i]).Name, aIndices);
    end;
  end;
  //***********************
end;

function TDMRecebeXML.fnc_Abrir_Nota(Filial, NumNota, ID_Cliente: Integer;
  Serie: String): Boolean;
begin
  Result := False;
  cdsNotaFiscal.Close;
  if vImportar_NotaSaida then
    sdsNotaFiscal.CommandText := 'SELECT * FROM NOTAFISCAL '
                               + 'WHERE ID = -0 '
  else
    sdsNotaFiscal.CommandText := 'SELECT * FROM NOTAFISCAL '
                               + ' WHERE FILIAL = ' + IntToStr(Filial)
                               + '   AND NUMNOTA = ' + IntToStr(NumNota)
                               + '   AND ID_CLIENTE = ' + IntToStr(ID_Cliente)
                               + '   AND SERIE = ' + QuotedStr(Serie)
                               + '   AND TIPO_REG = ' + QuotedStr('NTE');
  cdsNotaFiscal.Open;

  if not(vImportar_NotaSaida) then
    if not(cdsNotaFiscal.IsEmpty) and (cdsNotaFiscalNUMNOTA.AsInteger = NumNota) then
      Result := True;
end;

function TDMRecebeXML.fnc_Abrir_Produto_Forn(ID_Fornecedor: Integer; CodProdutoForn, CodBarra: String; Gravar: Boolean): Boolean;
var
  vContAux: Integer;
  vIDAux, vItemAux: Integer;
begin
  vProduto_Inativo := 'N';
  vGerar_CLiq      := 'N';
  Result := False;
  if (qParametrosPROCURAR_POR_REF_XML.AsString = 'S') and (not(Gravar)) then
  begin
    cdsProduto.Close;                //aqui mexer aqui     22/10/2015
    sdsProduto.CommandText := 'SELECT * FROM PRODUTO WHERE REFERENCIA = ' + QuotedStr(CodProdutoForn);
    cdsProduto.Open;
    if not cdsProduto.IsEmpty then
    begin
      Result := True;
      vProduto_Inativo := cdsProdutoINATIVO.AsString;
      vGerar_CLiq      := cdsProdutoUSA_CLIQ.AsString;
    end;
    cdsProduto_Forn.Close;
    sdsProduto_Forn.CommandText := ctProduto_Forn
                                 + ' WHERE PF.ID = ' + IntToStr(cdsProdutoID.AsInteger)
                                 + ' AND PF.COD_MATERIAL_FORN = ' + QuotedStr(CodProdutoForn)
                                 + ' AND PF.ID_FORNECEDOR = ' + IntToStr(ID_Fornecedor);
    cdsProduto_Forn.Open;
  end
  else
  if (qParametros_RecXMLPROCURAR_POR_CBARRA.AsString = 'S') and (not(Gravar)) then
  begin
    cdsProduto.Close;                //aqui mexer aqui     22/10/2015
    sdsProduto.CommandText := 'SELECT * FROM PRODUTO WHERE COD_BARRA = ' + QuotedStr(CodProdutoForn);
    cdsProduto.Open;
    if not cdsProduto.IsEmpty then
    begin
      Result := True;
      vProduto_Inativo := cdsProdutoINATIVO.AsString;
      vGerar_CLiq      := cdsProdutoUSA_CLIQ.AsString;
    end;
    cdsProduto_Forn.Close;
    sdsProduto_Forn.CommandText := ctProduto_Forn
                                 + ' WHERE PF.ID = ' + IntToStr(cdsProdutoID.AsInteger)
                                 + '   AND PF.COD_MATERIAL_FORN = ' + QuotedStr(CodProdutoForn)
                                 + '   AND PF.ID_FORNECEDOR = ' + IntToStr(ID_Fornecedor);
    cdsProduto_Forn.Open;
  end
  else
  begin
    cdsProduto_Forn.Close;
    {sdsProduto_Forn.CommandText := ' SELECT * FROM PRODUTO_FORN '
                                 + ' WHERE ID_FORNECEDOR = ' + IntToStr(ID_Fornecedor)
                                 + '   AND COD_MATERIAL_FORN = ' + QuotedStr(CodProdutoForn);}
    sdsProduto_Forn.CommandText := ctProduto_Forn
                                 + ' WHERE PF.ID_FORNECEDOR = ' + IntToStr(ID_Fornecedor)
                                 + '   AND PF.COD_MATERIAL_FORN = ' + QuotedStr(CodProdutoForn);
    cdsProduto_Forn.Open;
    cdsProduto_Forn.First;
    //aqui
    while not cdsProduto_Forn.Eof do
    begin
      if cdsProduto_FornINATIVO.AsString <> 'S' then
      begin
        vProduto_Inativo := 'N';
        vIDAux   := cdsProduto_FornID.AsInteger;
        vItemAux := cdsProduto_FornITEM.AsInteger;
        vGerar_CLiq := cdsProduto_FornUSA_CLIQ.AsString;
        cdsProduto_Forn.Last;
      end
      else
      begin
        vProduto_Inativo := 'S';
        vIDAux   := cdsProduto_FornID.AsInteger;
        vItemAux := cdsProduto_FornITEM.AsInteger;
      end;
      cdsProduto_Forn.Next;
    end;
    cdsProduto_Forn.Locate('ID;ITEM',VarArrayOf([vIDAux,vItemAux]),[locaseinsensitive]);
    //***********

    {if not cdsProduto_Forn.IsEmpty then
    begin
      if cdsProduto_FornINATIVO.AsString <> 'S' then
        vProduto_Inativo := 'N'
      else
        vProduto_Inativo := 'S';
    end;}

    if not cdsProduto_Forn.IsEmpty then
      Result := True;
  end;
end;

function TDMRecebeXML.fnc_Abrir_Fornecedor(CNPJ: String): Boolean;
begin
  Result := False;
  cdsFornecedor.Close;
  sdsFornecedor.CommandText := 'SELECT * FROM PESSOA '
                             + ' WHERE CNPJ_CPF = ' + QuotedStr(CNPJ);
  cdsFornecedor.Open;
  if not(cdsFornecedor.IsEmpty) or (cdsFornecedorCNPJ_CPF.AsString = CNPJ) then
    Result := True;
end;

procedure TDMRecebeXML.prc_Abrir_Produto(ID: Integer);
begin
  cdsProduto.Close;
  sdsProduto.CommandText := ctCommand_Produto;
  if ID <> 0 then
    sdsProduto.CommandText := sdsProduto.CommandText + ' WHERE ID = ' + IntToStr(ID);
  cdsProduto.Open;
end;

function TDMRecebeXML.fnc_Abrir_Cidade(CodMunicipio: String): Boolean;
begin
  Result := False;
  cdsCidade.Close;
  sdsCidade.CommandText := 'SELECT * FROM CIDADE '
                         + ' WHERE CODMUNICIPIO = ' + QuotedStr(CodMunicipio);
  cdsCidade.Open;
  if not(cdsCidade.IsEmpty) or (cdsCidadeCODMUNICIPIO.AsString = CodMunicipio) then
    Result := True;
end;

function TDMRecebeXML.fnc_Abrir_Pais(CodPais: String): Boolean;
begin
  Result := False;
  cdsPais.Close;
  sdsPais.CommandText := 'SELECT * FROM PAIS '
                       + ' WHERE CODPAIS = ' + QuotedStr(CodPais);
  cdsPais.Open;

  if not(cdsPais.IsEmpty) or (cdsPaisCODPAIS.AsString = CodPais) then
    Result := True;
end;

function TDMRecebeXML.fnc_Abrir_NCM(NCM: String): Integer;
begin
  Result := 0;
  cdsNCM.Close;
  sdsNCM.ParamByName('NCM').AsString := NCM;
  cdsNCM.Open;
  if not(cdsNCM.IsEmpty) then
    Result := cdsNCMID.AsInteger;
end;

procedure TDMRecebeXML.AbrirNFe(AXMLNFe: string);
begin
  if cdsCabecalho.Active then
    cdsCabecalho.Close;

  XMLTransformProvider1.XMLDataFile := AXMLNFe;
  cdsCabecalho.Open;
end;

procedure TDMRecebeXML.prc_Abrir_Estoque_Mov(ID: Integer);
begin
  cdsEstoque_Mov.Close;
  sdsEstoque_Mov.ParamByName('ID').AsInteger := ID;
  cdsEstoque_Mov.Open;
end;

procedure TDMRecebeXML.Gravar_Duplicata(Tipo, TransfICMS: String;
  Parcela: Integer; Valor: Real; Data: TDateTime);
var
  vAux: Integer;
begin
  if not cdsDuplicata.Active then
    Abrir_cdsDuplicata(0);

  vAux := dmDatabase.ProximaSequencia('DUPLICATA',0);

  cdsDuplicata.Insert;
  cdsDuplicataID.AsInteger := vAux;
  if Tipo = 'R' then
    cdsDuplicataTIPO_ES.AsString := 'E'
  else
    cdsDuplicataTIPO_ES.AsString := 'S';
  cdsDuplicataFILIAL.AsInteger        := cdsNotaFiscalFILIAL.AsInteger;
  cdsDuplicataID_NOTA.AsInteger       := cdsNotaFiscalID.AsInteger;
  cdsDuplicataPARCELA.AsInteger       := Parcela;
  cdsDuplicataNUMDUPLICATA.AsString   := cdsNotaFiscalNUMNOTA.AsString;
  cdsDuplicataNUMNOTA.AsInteger       := cdsNotaFiscalNUMNOTA.AsInteger;
  cdsDuplicataSERIE.AsString          := cdsNotaFiscalSERIE.AsString;
  cdsDuplicataDTVENCIMENTO.AsDateTime := Data;
  cdsDuplicataVLR_PARCELA.AsFloat     := StrToFloat(FormatFloat('0.00',Valor));
  cdsDuplicataVLR_RESTANTE.AsFloat    := StrToFloat(FormatFloat('0.00',Valor));
  cdsDuplicataVLR_PAGO.AsFloat        := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicataVLR_DEVOLUCAO.AsFloat   := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicataVLR_DESPESAS.AsFloat    := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicataVLR_DESCONTO.AsFloat    := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicataVLR_JUROSPAGOS.AsFloat  := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicataVLR_MULTA.AsFloat       := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicataVLR_COMISSAO.AsFloat    := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicataPERC_COMISSAO.AsFloat   := StrToFloat(FormatFloat('0.00',cdsNotaFiscalPERC_COMISSAO.AsFloat));
  cdsDuplicataPERC_BASE_COMISSAO.AsFloat := 100;

  cdsDuplicataDTULTPAGAMENTO.Clear;
  cdsDuplicataID_PESSOA.AsInteger     := cdsNotaFiscalID_CLIENTE.AsInteger;
  if cdsNotaFiscal_ParcID_TIPOCOBRANCA.AsInteger > 0 then
    cdsDuplicataID_CONTA.AsInteger := cdsNotaFiscal_ParcID_CONTA.AsInteger;
  if cdsNotaFiscal_ParcID_TIPOCOBRANCA.AsInteger > 0 then
    cdsDuplicataID_TIPOCOBRANCA.AsInteger := cdsNotaFiscal_ParcID_TIPOCOBRANCA.AsInteger;
  if cdsNotaFiscalID_VENDEDOR.AsInteger > 0 then
    cdsDuplicataID_VENDEDOR.AsInteger := cdsNotaFiscalID_VENDEDOR.AsInteger;
  if cdsNotaFiscal_ParcID_CONTA.AsInteger > 0 then
    cdsDuplicataID_CONTA_BOLETO.AsInteger := cdsNotaFiscal_ParcID_CONTA.AsInteger;
  cdsDuplicataID_COMISSAO.AsInteger       := 0;
  cdsDuplicataQTD_DIASATRASO.AsInteger    := 0;
  if cdsFornecedorFORNECEDOR_CONTA_ID.AsInteger > 0 then
    cdsDuplicataID_CONTA_ORCAMENTO.AsInteger := cdsFornecedorFORNECEDOR_CONTA_ID.AsInteger;

  cdsDuplicataDTRECEBIMENTO_TITULO.Clear;
  cdsDuplicataDTEMISSAO.AsDateTime        := cdsNotaFiscalDTSAIDAENTRADA.AsDateTime;
  cdsDuplicataPAGO_CARTORIO.AsString      := 'N';
  cdsDuplicataPROTESTADO.AsString         := 'N';
  cdsDuplicataTIPO_LANCAMENTO.AsString    := cdsNotaFiscalTIPO_REG.AsString;
  cdsDuplicataARQUIVO_GERADO.AsString     := 'N';
  cdsDuplicataTRANSFERENCIA_ICMS.AsString := TransfICMS;
  cdsDuplicataNOSSONUMERO.AsString        := '';
  cdsDuplicataDTFINANCEIRO.Clear;
  cdsDuplicataNUMCHEQUE.AsInteger         := 0;
  cdsDuplicataACEITE.AsString             := '';
  cdsDuplicataTIPO_MOV.AsString           := 'N';
  cdsDuplicataTITULO_CARTORIO.AsString    := 'N';
  //12/07/2016
  if vTerminal <= 0 then
    cdsDuplicataID_TERMINAL.Clear
  else
    cdsDuplicataID_TERMINAL.AsInteger := vTerminal;
  cdsDuplicata.Post;

  Gravar_Dupicata_Hist;

  cdsDuplicata.ApplyUpdates(0);
end;

procedure TDMRecebeXML.Gravar_Dupicata_Hist;
var
  vItemAux: Integer;
begin
  cdsDuplicata_Hist.Last;
  vItemAux := cdsDuplicata_HistITEM.AsInteger;
  vItemAux := vItemAux;

  cdsDuplicata_Hist.Insert;
  cdsDuplicata_HistID.AsInteger               := cdsDuplicataID.AsInteger;
  cdsDuplicata_HistITEM.AsInteger             := vItemAux;
  cdsDuplicata_HistTIPO_HISTORICO.AsString    := 'ENT';
  cdsDuplicata_HistID_HISTORICO.AsInteger     := 0;
  cdsDuplicata_HistCOMPLEMENTO.AsString       := 'ENTRADA DO TTULO';
  cdsDuplicata_HistDTHISTORICO.AsDateTime     := Date;
  cdsDuplicata_HistDTLANCAMENTO.AsDateTime    := cdsDuplicataDTEMISSAO.AsDateTime;
  cdsDuplicata_HistVLR_PAGAMENTO.AsFloat      := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicata_HistVLR_JUROSPAGOS.AsFloat     := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicata_HistVLR_MULTA.AsFloat          := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicata_HistVLR_DESCONTOS.AsFloat      := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicata_HistVLR_DESPESAS.AsFloat       := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicata_HistVLR_DEVOLUCAO.AsFloat      := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicata_HistVLR_JUROSCALCULADO.AsFloat := StrToFloat(FormatFloat('0.00',0));
  cdsDuplicata_HistNUMCHEQUE.AsInteger        := 0;
  cdsDuplicata_HistDTPREVISAO_CHEQUE.Clear;
  cdsDuplicata_HistID_CONTA.AsInteger         := cdsDuplicataID_CONTA.AsInteger;
  cdsDuplicata_HistID_COMISSAO.AsInteger      := 0;
  cdsDuplicata_HistTIPO_ES.AsString           := cdsDuplicataTIPO_ES.AsString;
  cdsDuplicata_HistVLR_LANCAMENTO.AsFloat     := cdsDuplicataVLR_PARCELA.AsFloat;
  cdsDuplicata_Hist.Post;
end;

procedure TDMRecebeXML.Abrir_cdsDuplicata(ID: Integer);
begin
  cdsDuplicata.Close;
  sdsDuplicata.CommandText := 'SELECT * FROM DUPLICATA WHERE ID = ' + IntToStr(ID);

  cdsDuplicata.Open;
end;

procedure TDMRecebeXML.dspNotaFiscalUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
  //raise Exception.Create('Erro ao tentar excluir: ' + #13 + e.Message);
end;

procedure TDMRecebeXML.dspProduto_FornUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
end;

procedure TDMRecebeXML.dspFornecedorUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
end;

procedure TDMRecebeXML.dspPaisUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
end;

procedure TDMRecebeXML.dspCidadeUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
end;

procedure TDMRecebeXML.dspProdutoUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
end;

procedure TDMRecebeXML.dspNCMUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
end;

procedure TDMRecebeXML.dspDuplicataUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
end;

procedure TDMRecebeXML.dspEstoque_MovUpdateError(Sender: TObject;
  DataSet: TCustomClientDataSet; E: EUpdateError; UpdateKind: TUpdateKind;
  var Response: TResolverResponse);
begin
  dmDatabase.prc_UpdateError(DataSet.Name,UpdateKind,E);
end;

procedure TDMRecebeXML.cdsNotaFiscal_ItensNewRecord(DataSet: TDataSet);
begin
  cdsNotaFiscal_ItensVLR_ADUANEIRA.AsFloat := 0;
  cdsNotaFiscal_ItensVLR_COFINS.AsFloat    := 0;
  cdsNotaFiscal_ItensVLR_DESCONTO.AsFloat  := 0;
  cdsNotaFiscal_ItensVLR_DESCONTORATEIO.AsFloat := 0;
  cdsNotaFiscal_ItensVLR_FRETE.AsFloat          := 0;
  cdsNotaFiscal_ItensVLR_ICMS.AsFloat           := 0;
  cdsNotaFiscal_ItensVLR_ICMSFRETE.AsFloat      := 0;
  cdsNotaFiscal_ItensVLR_ICMSOUTRASDESPESAS.AsFloat := 0;
  cdsNotaFiscal_ItensVLR_ICMSSIMPLES.AsFloat    := 0;
  cdsNotaFiscal_ItensVLR_ICMSSUBST.AsFloat      := 0;
  cdsNotaFiscal_ItensVLR_IMPORTACAO.AsFloat     := 0;
  cdsNotaFiscal_ItensVLR_IPI.AsFloat            := 0;
  cdsNotaFiscal_ItensVLR_OUTRASDESPESAS.AsFloat := 0;
  cdsNotaFiscal_ItensVLR_PIS.AsFloat            := 0;
  cdsNotaFiscal_ItensVLR_SEGURO.AsFloat         := 0;
  cdsNotaFiscal_ItensVLR_TOTAL.AsFloat          := 0;
  cdsNotaFiscal_ItensVLR_UNITARIO.AsFloat       := 0;
  cdsNotaFiscal_ItensVLR_DUPLICATA.AsFloat      := 0;
  cdsNotaFiscal_ItensITEM_NTE.AsInteger         := 0;
  cdsNotaFiscal_ItensQTD_NOTAATUAL.AsInteger    := 0;
  cdsNotaFiscal_ItensID_NTE.AsInteger           := 0;
  cdsNotaFiscal_ItensCOD_BARRA.AsString         := '';
  cdsNotaFiscal_ItensPERC_TRIBICMS.AsFloat      := 0;
  cdsNotaFiscal_ItensID_VARIACAO.AsInteger      := 0;
  cdsNotaFiscal_ItensID_PEDIDO.AsInteger        := 0;
  cdsNotaFiscal_ItensITEM_PEDIDO.AsInteger      := 0;
end;

procedure TDMRecebeXML.cdsNotaFiscal_ItensBeforePost(DataSet: TDataSet);
begin
  cdsNotaFiscal_ItensTIPO_REG.AsString := cdsNotaFiscalTIPO_REG.AsString;
end;

procedure TDMRecebeXML.DoLogAdditionalValues(ATableName: string;
  var AValues: TArrayLogData; var UserName: string);
begin
  UserName := vUsuario;
end;

procedure TDMRecebeXML.cdsNCMNewRecord(DataSet: TDataSet);
begin
  cdsNCMGERAR_ST.AsString := 'N';
end;

procedure TDMRecebeXML.mNotaNewRecord(DataSet: TDataSet);
begin
  mNotaFilial.AsInteger    := 0;
  mNotaID_Cidade.AsInteger := 0;
  mNotaID_Pais.AsInteger   := 0;
end;

procedure TDMRecebeXML.mItensNotaNewRecord(DataSet: TDataSet);
begin
  mItensNotaUsa_Cor.AsString          := 'N';
  mItensNotaUsa_Preco_Cor.AsString    := 'N';
  mItensNotaObs_Complementar.AsString := '';
  if qParametrosATUALIZAR_PRECO.AsString = 'S' then
    mItensNotaAtualizarPreco.AsBoolean := True
  else
    mItensNotaAtualizarPreco.AsBoolean := False;
  if qParametros_NTEATUALIZAR_CUSTO.AsString = 'S' then
    mItensNotaAtualizarCustoTotal.AsBoolean := True
  else
    mItensNotaAtualizarCustoTotal.AsBoolean := False;
  //mItensNotaAtualizarCustoLiq.AsBoolean := mItensNotaAtualizarPreco.AsBoolean;
  mItensNotaGerar_CLiquido.AsBoolean := False;
  mItensNotaPerc_Margem.AsFloat := StrToFloat(FormatFloat('0.00',qParametros_ProdPERC_MARGEM_PRECO.AsFloat));
  mItensNotaSUB_ICMS_CUSTO.AsString      := 'N';
  mItensNotaSUB_PISCOFINS_CUSTO.AsString := 'N';
  if qParametros_NTESUB_ICMS_CUSTO.AsString = 'S' then
    mItensNotaSUB_ICMS_CUSTO.AsString := 'S';
  if qParametros_NTESUB_PISCOFINS_CUSTO.AsString = 'S' then
    mItensNotaSUB_PISCOFINS_CUSTO.AsString := 'S';
  mItensNotaSOMAR_FRETE_NO_CUSTO.AsString := qParametros_NTESOMAR_FRETE_NO_CUSTO.AsString;
  mItensNotaSOMAR_IPI_NO_CUSTO.AsString   := qParametros_NTESOMAR_IPI_NO_CUSTO.AsString;
  mItensNotaSOMAR_ST_NO_CUSTO.AsString    := qParametros_NTESOMAR_ST_NO_CUSTO.AsString;
  mItensNotaGravar_Adic_Prod.AsString     := 'N';
  mItensNotaGerar_Estoque.AsString        := 'S';
end;

procedure TDMRecebeXML.prc_Abrir_Combinacao(ID_Produto: Integer);
begin
  cdsCombinacao.Close;
  sdsCombinacao.ParamByName('ID').AsInteger := ID_Produto;
  cdsCombinacao.Open;
end;

function TDMRecebeXML.fnc_Verifica_Produto_Forn(ID_Produto,ID_Fornecedor: Integer; Cod_Produto_Forn: String): Boolean;
var
  sds: TSQLDataSet;
begin
  Result := False;
  sds := TSQLDataSet.Create(nil);
  try
    sds.SQLConnection := dmDatabase.scoDados;
    sds.NoMetadata    := True;
    sds.GetMetadata   := False;
    sds.CommandText := 'SELECT PF.id, PF.id_fornecedor, PF.cod_material_forn '
                     + 'FROM produto_forn PF '
                     + 'WHERE PF.id = :ID '
                     + 'AND PF.ID_FORNECEDOR = :ID_FORNECEDOR '
                     + 'AND PF.COD_MATERIAL_FORN = :COD_MATERIAL_FORN ';
    sds.ParamByName('ID').AsInteger               := ID_Produto;
    sds.ParamByName('ID_Fornecedor').AsInteger    := ID_Fornecedor;
    sds.ParamByName('COD_MATERIAL_FORN').AsString := Cod_Produto_Forn;
    sds.Open;
    if not sds.IsEmpty then
      Result := True;
  finally
    FreeAndNil(sds);
  end;
end;

function TDMRecebeXML.fnc_Proximo_Item_Forn(ID_Produto: Integer): Integer;
var
  sds: TSQLDataSet;
begin
  Result := 0;
  sds := TSQLDataSet.Create(nil);
  try
    sds.SQLConnection := dmDatabase.scoDados;
    sds.NoMetadata    := True;
    sds.GetMetadata   := False;
    sds.CommandText := 'SELECT max(PF.ITEM) ITEM '
                     + 'FROM produto_forn PF '
                     + 'WHERE PF.id = :ID ';
    sds.ParamByName('ID').AsInteger := ID_Produto;
    sds.Open;
    Result := sds.FieldByName('ITEM').AsInteger;
  finally
    FreeAndNil(sds);
  end;
end;

procedure TDMRecebeXML.cdsFornecedorNewRecord(DataSet: TDataSet);
begin
  cdsFornecedorORGAO_PUBLICO.AsString            := 'N';
  cdsFornecedorCLIENTE_ESTOQUE.AsString          := 'N';
  cdsFornecedorUSA_TAMANHO_AGRUPADO_NFE.AsString := 'N';
  cdsFornecedorTP_ALUNO.AsString                 := 'N';
  cdsFornecedorTIPO_CONSUMIDOR.AsInteger         := 0;
  cdsFornecedorTIPO_CONTRIBUINTE.AsInteger       := 1;
  cdsFornecedorTP_PREPOSTO.AsString              := 'N';
  cdsFornecedorTP_EXPORTACAO.AsString            := 'N';
  cdsFornecedorASSOCIAR_PROD.AsString            := 'S';
end;

procedure TDMRecebeXML.mItensNotaBeforePost(DataSet: TDataSet);
begin
  if (trim(mItensNotaOrigem.AsString) = '') or (mItensNotaOrigem.IsNull) then
    mItensNotaOrigem.AsString := '0';
  if mItensNotaGravar_Adic_Prod.AsString = 's' then
    mItensNotaGravar_Adic_Prod.AsString := 'S';
end;

procedure TDMRecebeXML.prc_Move_Dados_Da_OC;
begin
  vNum_Pedido        := cdsOCNUM_PEDIDO.AsString;
  vID_Pedido         := cdsOCID.AsInteger;
  vItem_Pedido       := cdsOCITEM.AsInteger;
  vUnidade           := cdsOCUNIDADE.AsString;
  vCodProduto_Pos    := cdsOCID_PRODUTO.AsInteger;
  vReferencia_Pos    := cdsOCREFERENCIA.AsString;
  vUsa_Cor_Pos       := cdsOCUSA_COR.AsString;
  vUsa_Preco_Cor_Pos := cdsOCUSA_PRECO_COR.AsString;
  vID_Cor_Pos        := cdsOCID_COR.AsInteger;
end;

procedure TDMRecebeXML.cdsProduto_FornBeforePost(DataSet: TDataSet);
begin
  if (cdsProduto_FornCOD_COR_FORN.IsNull) or (trim(cdsProduto_FornCOD_COR_FORN.AsString) = '') then
    cdsProduto_FornCOD_COR_FORN.AsString := '';
  if (cdsProduto_FornTAMANHO_CLIENTE.IsNull) or (trim(cdsProduto_FornTAMANHO_CLIENTE.AsString) = '') then
    cdsProduto_FornTAMANHO_CLIENTE.AsString := '';
end;

procedure TDMRecebeXML.cdsDuplicataNewRecord(DataSet: TDataSet);
begin
  cdsDuplicataNGR.AsString      := 'N';
  cdsDuplicataAPROVADO.AsString := 'N';
end;

procedure TDMRecebeXML.prc_Inserir_Parcela;
begin
  cdsParcelas.Insert;
end;

end.
